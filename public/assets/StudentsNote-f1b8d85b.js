import{a as Qe,q as Xe,e as ke,x as Re,l as Pe,s as Ne,Z as et,N as tt,k as nt,_ as at,c as ot,v as rt}from"./bootstrap-vue-3.es-c041cbee.js";import{a9 as st,aa as lt,ab as it,ac as ut,ad as ct,ae as ft,af as dt,a3 as vt,ag as pt,V as Te,ah as mt,ai as gt,aj as bt,ak as ht,H as Be,a2 as yt,r as oe,al as _t,am as wt,a0 as Dt,an as xt,ao as Ft,I as Ct,i as Me,ap as Et,j as k,aq as St,ar as At,x as de,X as ze,n as kt,t as N,as as Rt,at as Pt,a7 as Nt,F as me,au as Tt,av as Bt,aw as Mt,a6 as zt,ax as jt,ay as Ot,az as It,aA as Vt,aB as Lt,J as re,z as Q,E as se,e as M,g as K,aC as $t,aD as qt,aE as Kt,aF as Ht,aG as Jt,k as P,f as _,aH as Ut,d as ge,aI as Gt,aJ as Wt,aK as Zt,aL as Yt,a8 as Qt,aM as Xt,Y as je,N as en,aN as tn,aO as nn,Z as an,aP as on,aQ as rn,aR as sn,aS as ln,O as Oe,M as un,S as cn,s as fn,W as dn,aT as vn,aU as pn,aV as mn,o as be,aW as gn,aX as bn,aY as hn,a as yn,aZ as _n,c as A,l as wn,a_ as Dn,p as xn,a$ as Fn,b0 as Cn,v as Ie,P as En,b as Sn,b1 as An,A as kn,b2 as Rn,b3 as Pn,b4 as Nn,b5 as Tn,b6 as Bn,b7 as Mn,b8 as zn,b9 as jn,ba as On,Q as In,bb as Vn,L as Ln,bc as $n,bd as qn,be as Kn,K as Hn,a1 as Jn,bf as Un,bg as Gn,bh as Wn,w as m,bi as Zn,T as Yn,bj as Qn,bk as Xn,$ as ea,bl as ta,bm as na,bn as aa,bo as oa,bp as ra,bq as sa,br as la,bs as ia,bt as ua,bu as ca,bv as fa,bw as da,bx as va,by as pa,U as ma,bz as ga,a5 as ba,a4 as ha,bA as ya,bB as Ve,bC as Le,q as $e,_ as _a,C as wa,D as Da,G as xa}from"./index-507cb3d4.js";import{F as Fa,e as Ca,E as Ea}from"./FileSaver.min-55380b27.js";const Sa=()=>{},Aa=Object.freeze(Object.defineProperty({__proto__:null,compile:Sa,EffectScope:st,ReactiveEffect:lt,customRef:it,effect:ut,effectScope:ct,getCurrentScope:ft,isProxy:dt,isReactive:vt,isReadonly:pt,isRef:Te,isShallow:mt,markRaw:gt,onScopeDispose:bt,proxyRefs:ht,reactive:Be,readonly:yt,ref:oe,shallowReactive:_t,shallowReadonly:wt,shallowRef:Dt,stop:xt,toRaw:Ft,toRef:Ct,toRefs:Me,triggerRef:Et,unref:k,camelize:St,capitalize:At,normalizeClass:de,normalizeProps:ze,normalizeStyle:kt,toDisplayString:N,toHandlerKey:Rt,BaseTransition:Pt,Comment:Nt,Fragment:me,KeepAlive:Tt,Static:Bt,Suspense:Mt,Teleport:zt,Text:jt,callWithAsyncErrorHandling:Ot,callWithErrorHandling:It,cloneVNode:Vt,compatUtils:Lt,computed:re,createBlock:Q,createCommentVNode:se,createElementBlock:M,createElementVNode:K,createHydrationRenderer:$t,createPropsRestProxy:qt,createRenderer:Kt,createSlots:Ht,createStaticVNode:Jt,createTextVNode:P,createVNode:_,defineAsyncComponent:Ut,defineComponent:ge,defineEmits:Gt,defineExpose:Wt,defineProps:Zt,get devtools(){return Yt},getCurrentInstance:Qt,getTransitionRawChildren:Xt,guardReactiveProps:je,h:en,handleError:tn,initCustomFormatter:nn,inject:an,isMemoSame:on,isRuntimeOnly:rn,isVNode:sn,mergeDefaults:ln,mergeProps:Oe,nextTick:un,onActivated:cn,onBeforeMount:fn,onBeforeUnmount:dn,onBeforeUpdate:vn,onDeactivated:pn,onErrorCaptured:mn,onMounted:be,onRenderTracked:gn,onRenderTriggered:bn,onServerPrefetch:hn,onUnmounted:yn,onUpdated:_n,openBlock:A,popScopeId:wn,provide:Dn,pushScopeId:xn,queuePostFlushCb:Fn,registerRuntimeCompiler:Cn,renderList:Ie,renderSlot:En,resolveComponent:Sn,resolveDirective:An,resolveDynamicComponent:kn,resolveFilter:Rn,resolveTransitionHooks:Pn,setBlockTracking:Nn,setDevtoolsHook:Tn,setTransitionHooks:Bn,ssrContextKey:Mn,ssrUtils:zn,toHandlers:jn,transformVNodeArgs:On,useAttrs:In,useSSRContext:Vn,useSlots:Ln,useTransitionState:$n,version:qn,warn:Kn,watch:Hn,watchEffect:Jn,watchPostEffect:Un,watchSyncEffect:Gn,withAsyncContext:Wn,withCtx:m,withDefaults:Zn,withDirectives:Yn,withMemo:Qn,withScopeId:Xn,Transition:ea,TransitionGroup:ta,VueElement:na,createApp:aa,createSSRApp:oa,defineCustomElement:ra,defineSSRCustomElement:sa,hydrate:la,initDirectivesForSSR:ia,render:ua,useCssModule:ca,useCssVars:fa,vModelCheckbox:da,vModelDynamic:va,vModelRadio:pa,vModelSelect:ma,vModelText:ga,vShow:ba,withKeys:ha,withModifiers:ya},Symbol.toStringTag,{value:"Module"}));function ka(e,t=new Date().getTime().toString()){return e.xlsx.writeBuffer().then(n=>{const o=new Blob([n],{type:"application/vnd.ms-excel"});Fa.saveAs(o,`${t}.xlsx`)})}var H=(e=>(e[e.Border=0]="Border",e[e.Protection=1]="Protection",e[e.Validation=2]="Validation",e[e.Fill=3]="Fill",e))(H||{});const fe=(e,t,n,o=H.Border,a="thin",s="F08080")=>{const i={top:{style:a},left:{style:a},bottom:{style:a},right:{style:a}};if(o===H.Fill)for(let c=t.column;c<n.column;c++)e.getCell(t.row,c).fill={type:"pattern",pattern:"solid",fgColor:{argb:s}};else for(let c=t.row;c<n.row;c++)for(let d=t.column;d<n.column;d++)o===H.Border&&(e.getCell(c,d).border=i),o===H.Protection&&(e.getCell(c,d).protection={locked:!1}),o===H.Validation&&(e.getCell(c,d).dataValidation={type:"decimal",operator:"between",allowBlank:!0,showErrorMessage:!0,formulae:[0,10],promptTitle:"Decimal",errorStyle:"error",errorTitle:"Valor no valido",error:"El valor debe ser un numero, Debe ser mayor que cero y menor o igual a 10"})},Ra=(e,t,n)=>{const[o]=e,a=new Ca.Workbook,s=new FileReader;return new Promise((i,c)=>{s.readAsArrayBuffer(o),s.onerror=()=>{c("Tenemos un problema para poder leer el documento")},s.onload=()=>{const d=s.result;a.xlsx.load(d).then(u=>{var b;const l=[],v=u.worksheets[0],I=(b=v.getCell("A1").value)==null?void 0:b.toString();console.log(n,I),n.toString()!==I&&c("El Documento no es valido para esta asignatura"),v.eachRow({includeEmpty:!0},function(Z,C){var z,V,L;if(C>7){const T=v.getRow(C),x=parseFloat((z=T.getCell(t).value)==null?void 0:z.toString())||0;l.push({carnet:((V=T.getCell(3).value)==null?void 0:V.toString())||"",nombre:((L=T.getCell(4).value)==null?void 0:L.toString())||"",color:x<5?"bg-danger":x>=5&&x<=8?"bg-warning":"bg-primary",valor:x})}}),i(l)})}})},Pa=(e,t)=>{e.mergeCells("B2:J2"),e.mergeCells("B4:E4"),e.mergeCells("B5:E5"),e.mergeCells("F4:J4"),e.mergeCells("F5:J5");const[n]=t;e.getCell("A1").value=n.carga_academica_id,e.getCell("J2").value="NOMBRE MATERIA",e.getCell("E4").value="Codigo: CODIGO DE CARGA ACADEMICA",e.getCell("E5").value="Docente: NOMBRE DEL DOCENTE",e.getCell("J5").value="Horario",[{column:0,width:1},{column:1,width:5.5},{column:2,width:12.1},{column:3,width:48.4},{column:4,width:28.25}].forEach(({column:a,width:s})=>{e.columns[a].width=s})},Na=e=>{["J2","E4","E5","J4","J5"].map(t=>{const n=t==="J2";e.getCell(t).alignment={vertical:"middle",horizontal:"center"},e.getCell(t).font={name:"Arial",size:n?14:12,bold:!!n}}),e.getCell("A1").font={color:{argb:"FFFFFFFF",theme:1}}},Ta=async e=>{const t=new Ea.Workbook,n=t.addWorksheet("Cuadro de notas"),o=new Date().getTime()+"--pass--word--secret";await n.protect(o,{});let a=new Array;e&&(Pa(n,e),a=e.map((i,c)=>[c+1,i.alumno.carnet,`${i.alumno.apellidos} ${i.alumno.nombres}`,`${i.alumno.carnet}@correo.edu.sv`])),n.addTable({ref:"B7",name:"notas",headerRow:!0,totalsRow:!1,style:{theme:"TableStyleLight1",showRowStripes:!0},columns:[{name:"#",filterButton:!1},{name:"Carnet",filterButton:!1},{name:"Alumno",filterButton:!1},{name:"Correo",filterButton:!1}],rows:[...a]}),Na(n),fe(n,{row:7,column:2},{column:12,row:8+a.length}),fe(n,{row:8,column:6},{column:11,row:8+a.length},H.Protection),fe(n,{row:8,column:6},{column:11,row:8+a.length},H.Validation);const s=`${new Date().getTime()}`;return ka(t,s)};var qe={};const Ba=Ve(Aa);function X(e,t,n,o){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function c(l){try{u(o.next(l))}catch(v){i(v)}}function d(l){try{u(o.throw(l))}catch(v){i(v)}}function u(l){l.done?s(l.value):a(l.value).then(c,d)}u((o=o.apply(e,t||[])).next())})}function ee(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,a,s,i;return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return d([u,l])}}function d(u){if(o)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(o=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,a=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],a=0}finally{o=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Ma(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),a,s=[],i;try{for(;(t===void 0||t-- >0)&&!(a=o.next()).done;)s.push(a.value)}catch(c){i={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function za(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ma(arguments[t]));return e}var ja=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function ie(e,t){var n=Oa(e);if(typeof n.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(n,"path",{value:typeof t=="string"?t:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}function Oa(e){var t=e.name,n=t&&t.lastIndexOf(".")!==-1;if(n&&!e.type){var o=t.split(".").pop().toLowerCase(),a=ja.get(o);a&&Object.defineProperty(e,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return e}var Ia=[".DS_Store","Thumbs.db"];function Va(e){return X(this,void 0,void 0,function(){return ee(this,function(t){return[2,La(e)&&e.dataTransfer?Ka(e.dataTransfer,e.type):$a(e)]})})}function La(e){return!!e.dataTransfer}function $a(e){var t=qa(e.target)?e.target.files?ve(e.target.files):[]:[];return t.map(function(n){return ie(n)})}function qa(e){return e!==null}function Ka(e,t){return X(this,void 0,void 0,function(){var n,o;return ee(this,function(a){switch(a.label){case 0:return e.items?(n=ve(e.items).filter(function(s){return s.kind==="file"}),t!=="drop"?[2,n]:[4,Promise.all(n.map(Ha))]):[3,2];case 1:return o=a.sent(),[2,we(Ke(o))];case 2:return[2,we(ve(e.files).map(function(s){return ie(s)}))]}})})}function we(e){return e.filter(function(t){return Ia.indexOf(t.name)===-1})}function ve(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];t.push(o)}return t}function Ha(e){if(typeof e.webkitGetAsEntry!="function")return De(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?He(t):De(e)}function Ke(e){return e.reduce(function(t,n){return za(t,Array.isArray(n)?Ke(n):[n])},[])}function De(e){var t=e.getAsFile();if(!t)return Promise.reject(e+" is not a File");var n=ie(t);return Promise.resolve(n)}function Ja(e){return X(this,void 0,void 0,function(){return ee(this,function(t){return[2,e.isDirectory?He(e):Ua(e)]})})}function He(e){var t=e.createReader();return new Promise(function(n,o){var a=[];function s(){var i=this;t.readEntries(function(c){return X(i,void 0,void 0,function(){var d,u,l;return ee(this,function(v){switch(v.label){case 0:if(c.length)return[3,5];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Promise.all(a)];case 2:return d=v.sent(),n(d),[3,4];case 3:return u=v.sent(),o(u),[3,4];case 4:return[3,6];case 5:l=Promise.all(c.map(Ja)),a.push(l),s(),v.label=6;case 6:return[2]}})})},function(c){o(c)})}s()})}function Ua(e){return X(this,void 0,void 0,function(){return ee(this,function(t){return[2,new Promise(function(n,o){e.file(function(a){var s=ie(a,e.fullPath);n(s)},function(a){o(a)})})]})})}const Ga=Object.freeze(Object.defineProperty({__proto__:null,fromEvent:Va},Symbol.toStringTag,{value:"Module"})),Wa=Ve(Ga);var he={};he.__esModule=!0;he.default=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),o=e.name||"",a=(e.type||"").toLowerCase(),s=a.replace(/\/.*$/,"");return n.some(function(i){var c=i.trim().toLowerCase();return c.charAt(0)==="."?o.toLowerCase().endsWith(c):c.endsWith("/*")?s===c.replace(/\/.*$/,""):a===c})}return!0};Object.defineProperty(qe,"__esModule",{value:!0});var S=Ba,Za=Wa;function Ya(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Qa=Ya(he),g=function(){return(g=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function xe(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n}function Xa(e,t,n,o){return new(n||(n=Promise))(function(a,s){function i(u){try{d(o.next(u))}catch(l){s(l)}}function c(u){try{d(o.throw(u))}catch(l){s(l)}}function d(u){var l;u.done?a(u.value):(l=u.value,l instanceof n?l:new n(function(v){v(l)})).then(i,c)}d((o=o.apply(e,t||[])).next())})}function eo(e,t){var n,o,a,s,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(d){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!((a=a.length>0&&a[a.length-1])||l[0]!==6&&l[0]!==2)){i=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(l[0]===6&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(v){l=[6,v],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([d,u])}}}function pe(e,t){for(var n=0,o=t.length,a=e.length;n<o;n++,a++)e[a]=t[n];return e}function Fe(e){e.preventDefault()}function ae(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function le(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():e.cancelBubble!==void 0&&e.cancelBubble}var to={code:"too-many-files",message:"Too many files"},no=function(e){return e=Array.isArray(e)&&e.length===1?e[0]:e,{code:"file-invalid-type",message:"File type must be "+(Array.isArray(e)?"one of "+e.join(", "):e)}};function Y(e){return e!=null}function Ce(e,t){var n=e.type==="application/x-moz-file"||Qa.default(e,t);return[n,n?null:no(t)]}var Ee=function(e){return{code:"file-too-large",message:"File is larger than "+e+" bytes"}},Se=function(e){return{code:"file-too-small",message:"File is smaller than "+e+" bytes"}};function Ae(e,t,n){if(Y(e.size)&&e.size)if(Y(t)&&Y(n)){if(e.size>n)return[!1,Ee(n)];if(e.size<t)return[!1,Se(t)]}else{if(Y(t)&&e.size<t)return[!1,Se(t)];if(Y(n)&&e.size>n)return[!1,Ee(n)]}return[!0,null]}function B(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(n){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];return e.some(function(s){return!le(n)&&s&&s.apply(void 0,pe([n],o)),le(n)})}}var ao={disabled:!1,getFilesFromEvent:Za.fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1};function oo(e,t){switch(t.type){case"focus":return g(g({},e),{isFocused:!0});case"blur":return g(g({},e),{isFocused:!1});case"openDialog":return g(g({},e),{isFileDialogActive:!0});case"closeDialog":return g(g({},e),{isFileDialogActive:!1});case"setDraggedFiles":var n=t.isDragActive,o=t.draggedFiles;return g(g({},e),{draggedFiles:o,isDragActive:n});case"setFiles":return g(g({},e),{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return g(g({},e),{isFileDialogActive:!1,isDragActive:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]});default:return e}}var ro=qe.useDropzone=function(e){e===void 0&&(e={});var t=S.ref(g(g({},ao),e));S.watch(function(){return g({},e)},function(r){t.value=g(g({},t.value),r)});var n=S.ref(),o=S.ref(),a=function(r,f,h){var w=S.reactive(f),D=function(E){var y=r(S.toRaw(w),E);Object.keys(y).forEach(function(R){w[R]=y[R]})};return h!=null&&D(h),[w,D]}(oo,{isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]}),s=a[0],i=a[1],c=function(){o.value&&(i({type:"openDialog"}),o.value.value="",o.value.click())},d=function(){var r=t.value.onFileDialogCancel;s.isFileDialogActive&&setTimeout(function(){if(o.value){var f=o.value.files;f&&!f.length&&(i({type:"closeDialog"}),typeof r=="function"&&r())}},300)};function u(r){n.value&&(n.value.$el||n.value).isEqualNode(r.target)&&(r.keyCode!==32&&r.keyCode!==13||(r.preventDefault(),c()))}function l(){i({type:"focus"})}function v(){i({type:"blur"})}function I(){var r;t.value.noClick||(r===void 0&&(r=window.navigator.userAgent),function(f){return f.includes("MSIE")||f.includes("Trident/")}(r)||function(f){return f.includes("Edge/")}(r)?setTimeout(c,0):c())}var b=S.ref([]),Z=function(r){n.value&&((n.value.$el||n.value).contains(r.target)||(r.preventDefault(),b.value=[]))};function C(r){t.value.noDragEventsBubbling&&r.stopPropagation()}function z(r){return Xa(this,void 0,void 0,function(){var f,h,w,D,E;return eo(this,function(y){switch(y.label){case 0:return f=t.value,h=f.getFilesFromEvent,w=f.noDragEventsBubbling,D=f.onDragEnter,r.preventDefault(),C(r),b.value=pe(pe([],b.value),[r.target]),ae(r)?h?[4,h(r)]:[2]:[3,2];case 1:if((E=y.sent())||(E=[]),le(r)&&!w)return[2];i({draggedFiles:E,isDragActive:!0,type:"setDraggedFiles"}),D&&D(r),y.label=2;case 2:return[2]}})})}function V(r){var f=t.value.onDragOver;if(r.preventDefault(),C(r),r.dataTransfer)try{r.dataTransfer.dropEffect="copy"}catch{}return ae(r)&&f&&f(r),!1}function L(r){r.preventDefault(),C(r);var f=b.value.filter(function(D){return!!n.value&&(n.value.$el||n.value).contains(D)}),h=f.indexOf(r.target);if(h!==-1&&f.splice(h,1),b.value=f,!(f.length>0)){i({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]});var w=t.value.onDragLeave;ae(r)&&w&&w(r)}}function T(r){r.preventDefault(),C(r),b.value=[];var f=t.value,h=f.getFilesFromEvent,w=f.noDragEventsBubbling,D=f.accept,E=f.minSize,y=f.maxSize,R=f.multiple,J=f.maxFiles,U=f.onDrop,te=f.onDropRejected,ne=f.onDropAccepted;if(ae(r)){if(!h)return;Promise.resolve(h(r)).then(function(ce){if(!le(r)||w){var O=[],G=[];ce.forEach(function(W){var ye=Ce(W,D),Je=ye[0],Ue=ye[1],_e=Ae(W,E,y),Ge=_e[0],We=_e[1];if(Je&&Ge)O.push(W);else{var Ze=[Ue,We].filter(function(Ye){return Ye});G.push({file:W,errors:Ze})}}),(!R&&O.length>1||R&&J>=1&&O.length>J)&&(O.forEach(function(W){G.push({file:W,errors:[to]})}),O.splice(0)),i({acceptedFiles:O,fileRejections:G,type:"setFiles"}),U&&U(O,G,r),G.length>0&&te&&te(G,r),O.length>0&&ne&&ne(O,r)}})}i({type:"reset"})}S.onMounted(function(){window.addEventListener("focus",d,!1),t.value.preventDropOnDocument&&(document.addEventListener("dragover",Fe,!1),document.addEventListener("drop",Z,!1))}),S.onUnmounted(function(){window.removeEventListener("focus",d,!1),t.value.preventDropOnDocument&&(document.removeEventListener("dragover",Fe),document.removeEventListener("drop",Z))});var x=function(r){return t.value.disabled?void 0:r},$=function(r){return t.value.noKeyboard?void 0:x(r)},j=function(r){return t.value.noDrag?void 0:x(r)},p=function(r){r.stopPropagation()},F=S.computed(function(){return s.draggedFiles?s.draggedFiles.length:0}),q=S.computed(function(){return F.value>0&&function(r){var f=r.files,h=r.accept,w=r.minSize,D=r.maxSize,E=r.multiple,y=r.maxFiles;return!(!E&&f.length>1||E&&y>=1&&f.length>y)&&f.every(function(R){var J=Ce(R,h)[0],U=Ae(R,w,D)[0];return J&&U})}({files:s.draggedFiles,accept:t.value.accept,minSize:t.value.minSize,maxSize:t.value.maxSize,multiple:t.value.multiple,maxFiles:t.value.maxFiles})}),ue=S.computed(function(){return F.value>0&&!q.value});return g(g({},S.toRefs(s)),{isDragAccept:q,isDragReject:ue,isFocused:S.computed(function(){return s.isFocused&&!t.value.disabled}),getRootProps:function(r){r===void 0&&(r={});var f=r.onKeyDown,h=r.onFocus,w=r.onBlur,D=r.onClick,E=r.onDragEnter,y=r.onDragenter,R=r.onDragOver,J=r.onDragover,U=r.onDragLeave,te=r.onDragleave,ne=r.onDrop,ce=xe(r,["onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragenter","onDragOver","onDragover","onDragLeave","onDragleave","onDrop"]);return g(g({onKeyDown:$(B(f,u)),onFocus:$(B(h,l)),onBlur:$(B(w,v)),onClick:x(B(D,I)),onDragenter:j(B(E,y,z)),onDragover:j(B(R,J,V)),onDragleave:j(B(U,te,L)),onDrop:j(B(ne,T)),ref:n},t.value.disabled||t.value.noKeyboard?{}:{tabIndex:0}),ce)},getInputProps:function(r){r===void 0&&(r={});var f=r.onChange,h=r.onClick,w=xe(r,["onChange","onClick"]),D={accept:t.value.accept,multiple:t.value.multiple,style:"display: none",type:"file",onChange:x(B(f,T)),onClick:x(B(h,p)),autoComplete:"off",tabIndex:-1,ref:o};return g(g({},D),w)},rootRef:n,inputRef:o,open:x(c)})};const so={key:0,class:"files"},lo={key:0},io={key:1,class:"text-center"},uo={key:0,class:"text-center"},co={key:0,class:"d-flex justify-content-end mt-4"},fo=ge({__name:"SubirNotasModal",props:{show:{type:Boolean},carga:null},emits:["close","send"],setup(e,{emit:t}){const n=e,o=["carnet","nombre","valor"],a=$e(),s=Le(),i=oe([]),c=oe(!1),d=oe(void 0),u=new Map;u.set(1,"F"),u.set(2,"G"),u.set(3,"H"),u.set(4,"I"),u.set(5,"J");const l=Be({files:[]}),{getRootProps:v,getInputProps:I,isDragActive:b,...Z}=ro({onDrop:function(p){l.files=p},accept:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]}),{show:C,carga:z}=Me(n),V=re(()=>{const p=[],F=z.value;return F.e1==="N"&&p.push({value:1,text:"Nota 1"}),F.e2==="N"&&p.push({value:2,text:"Nota 2"}),F.e3==="N"&&p.push({value:3,text:"Nota 3"}),F.e4==="N"&&p.push({value:4,text:"Nota 4"}),F.e5==="N"&&p.push({value:5,text:"Nota 5"}),p}),L=()=>{j(),t("close")},T=()=>{i.value=[],l.files.splice(0,1)},x=p=>{if(p.preventDefault(),$&&d){const F=d.value!==void 0?u.get(+d.value):"F";Ra(l.files,F,+a.params.id).then(q=>{i.value=q,c.value=!0}).catch(q=>{s.showAlert({detail:q,summary:"Error",severity:"error"}),c.value=!1})}},$=re(()=>d&&l.files.length>0),j=()=>{l.files=[],i.value=[],d.value=void 0,c.value=!1};return be(()=>{j()}),(p,F)=>{const q=Qe,ue=Xe,r=ke,f=Re,h=Pe,w=Ne,D=et,E=tt;return A(),Q(E,{id:"modal-1",title:"Notas",modelValue:k(C),"onUpdate:modelValue":F[1]||(F[1]=y=>Te(C)?C.value=y:null),onHide:L,size:"xl","hide-footer":"",scrollable:"","no-close-on-esc":!0,"no-close-on-backdrop":!0},{default:m(()=>[_(D,{fluid:""},{default:m(()=>[_(f,null,{default:m(()=>[_(r,{cols:"4"},{default:m(()=>[_(ue,{id:"nota-group",label:"Nota","label-for":"nota-input"},{default:m(()=>[_(q,{modelValue:d.value,"onUpdate:modelValue":F[0]||(F[0]=y=>d.value=y),required:"",options:k(V),id:"nota-input"},null,8,["modelValue","options"])]),_:1}),_(f,null,{default:m(()=>[_(r,{class:"mt-3"},{default:m(()=>[l.files.length>0?(A(),M("div",so,[(A(!0),M(me,null,Ie(l.files,(y,R)=>(A(),M("div",{class:"file-item",key:R},[K("span",null,N(y.name),1),K("span",{class:"delete-file",onClick:T},"Eliminar")]))),128))])):(A(),M("div",Oe({key:1},k(v)(),{class:"dropzone"}),[K("div",{class:de(["border",{isDragActive:k(b)}])},[K("input",ze(je(k(I)())),null,16),k(b)?(A(),M("p",lo,"Suelta el archivo aquí ....")):(A(),M("p",io," Arrastre y suelte archivos aquí, o haga clic para seleccionar archivos "))],2)],16))]),_:1})]),_:1}),_(h,{class:"mt-4",disabled:!k($),onClick:x,variant:"primary"},{default:m(()=>[P("Ver")]),_:1},8,["disabled"])]),_:1}),_(r,{class:"d-flex justify-content-center align-items-center"},{default:m(()=>[i.value.length===0?(A(),M("h2",uo," Debes seleccionar un archivo valido. ")):(A(),Q(w,{key:1,items:i.value,bordered:"",hover:"",small:"",fields:o},{"cell(valor)":m(({item:y})=>[K("span",{class:de(["d-block text-center badge",y.color])},N(y.valor.toFixed(2)),3)]),_:1},8,["items"]))]),_:1})]),_:1})]),_:1}),c.value?(A(),M("div",co,[_(h,{variant:"primary"},{default:m(()=>[P("Subir notas")]),_:1})])):se("",!0)]),_:1},8,["modelValue"])}}});const vo=_a(fo,[["__scopeId","data-v-b56dc085"]]),po={class:"file-content"},mo=K("h5",null,"Listado de estudiantes",-1),yo=ge({__name:"StudentsNote",setup(e){const t=$e(),n=Le(),o=wa(),{carga:a,open:s}=Da(o),i=[{key:"carnet",label:"Carnet",sortable:!1},{key:"estudiante",label:"Estudiante",sortable:!1}],c=re(()=>{var b;return(b=a.value)!=null&&b.materia?a.value.materia.toString():""}),d=async()=>{const b=a.value;b&&await Ta(b)},u=()=>{o.toggleShowModal(!0)},l=()=>{o.toggleShowModal()},v=b=>parseFloat(b).toFixed(2),I=b=>{o.sendNotesCarga(b).then(()=>{n.showAlert({summary:"Exito!",detail:"Proceso realizado con exito",severity:"success"})})};return be(()=>{const{id:b}=t.params;o.getDataCargaAcademica(+b)}),(b,Z)=>{const C=ke,z=Pe,V=nt,L=Re,T=at,x=ot,$=Ne,j=rt;return A(),M(me,null,[_(xa,{main:"Cargas Academicas",title:k(c),button:!0},null,8,["title"]),K("div",po,[_(j,{"no-body":""},{default:m(()=>[_(x,null,{default:m(()=>[_(T,null,{default:m(()=>[_(L,null,{default:m(()=>[_(C,{cols:"8"},{default:m(()=>[mo]),_:1}),_(C,{cols:"4",class:"d-flex justify-content-end"},{default:m(()=>[_(V,null,{default:m(()=>[_(z,{variant:"primary",onClick:d},{default:m(()=>[P("Descargar Listado")]),_:1}),_(z,{onClick:u},{default:m(()=>[P("Subir Notas")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),k(a)?(A(),Q($,{key:0,fields:i,items:k(a),class:"text-center",striped:"",bordered:"",borderless:"",small:"",hover:""},{"cell(estudiante)":m(({item:p})=>[P(N(p.alumno.apellidos)+" "+N(p.alumno.nombres),1)]),"cell(nota1)":m(({item:p})=>[P(N(v(p.nota1)),1)]),"cell(nota2)":m(({item:p})=>[P(N(v(p.nota2)),1)]),"cell(nota3)":m(({item:p})=>[P(N(v(p.nota3)),1)]),"cell(nota4)":m(({item:p})=>[P(N(v(p.nota4)),1)]),"cell(nota5)":m(({item:p})=>[P(N(v(p.nota5)),1)]),"cell(promedio)":m(({item:p})=>[P(N(v(p.promedio)),1)]),_:1},8,["items"])):se("",!0)]),_:1})]),k(a)?(A(),Q(vo,{key:0,show:k(s),onClose:l,onSend:I,carga:k(a)},null,8,["show","carga"])):se("",!0)],64)}}});export{yo as default};
