import{p as T,h as D}from"./bootstrap-vue-3.es-0c7ec6a3.js";import{m as q,u as M,bF as H,bG as U,r as C,D as z,bH as G,K as g,bI as K,o as W,J as v,bJ as P,h as R,bK as J,d as w,i as k,c as d,e as u,g as r,t as h,j as i,x as O,F as x,v as A,z as Q,_ as F,E as I,aG as X,f as y,w as S,G as Y,k as B}from"./index-d66447e3.js";import{E as Z,F as ee}from"./FileSaver.min-4390d796.js";const se=async(a="me")=>await P.get(`/v1/alumno/${a}/pensum`),ae=async(a=[])=>await P.post("pensum",{ids:a}),te=()=>{const a=q(),l=M(),t=R(),n=H();U();const c=C([]),s=C([]),{pensumList:p,asesoria:b,list:_,enrolled:E}=z(n);if(_.value)c.value=b.value;else{const{data:e}=G({queryKey:"pensum",queryFn:()=>se(),onSuccess:o=>{n.setListPensum(o)},onError:o=>{a.showAlert({summary:"Error",severity:"error",detail:"Tenemos un problema por el momento para mostrar la informacion, pongase en contacto con el administrador"}),a.setLoading(!1)},retry:0,cacheTime:0,enabled:!_.value});g(e,o=>{o&&(n.setListPensum(o),a.setLoading(!1))})}const{isLoading:L,mutate:$}=K(e=>ae(e),{onSuccess(e){a.showAlert({summary:"Exito",severity:"success",detail:"La matricula fue envianda con exito!"}),n.setSubjectEnrolled(e),t.replace({name:"pensum-list"})},onError(){a.showAlert({summary:"Error",severity:"error",detail:"Por el momento tenemos un problema intenta mas tarde, por favor"}),t.replace({name:"pensum-list"})}});return W(()=>{_.value||a.setLoading(!0)}),g(L,e=>{a.setLoading(e)}),g(b,(e,o)=>{o.length===0&&(c.value=e)}),g(s,e=>{const o=e.map(m=>m.codmate),j=b.value.map(m=>({...m,visible:!o.includes(m.codmate)}));c.value=j}),{paginate(e={}){n.getPagination(e)},sendAsesoria(){const e=[];s.value.forEach(({item:{id:o}})=>{e.push(o)}),$(e)},validarSubjects:(e,o,j)=>{let m=!0;const{dias:V,horas:N}=e;if(s.value.length>=5&&(m=!1,a.showAlert({severity:"error",summary:"Error!",detail:"Solo puedes seleccionar una maximo de 5 materias"})),m&&s.value.length>0&&(m=!s.value.some(({item:f})=>f.dias===V&&f.horas===N),m||a.showAlert({severity:"error",summary:"Error!",detail:"Hay una materia ya seleccionada con este horario"})),m){const f={item:e,codmate:o,nommate:j};s.value=[f,...s.value]}},removeSubjects:e=>{s.value=s.value.filter(o=>o.codmate!==e)},list:v(()=>p.value),carrera:v(()=>{var e;return(e=_.value)==null?void 0:e.carrera}),viewBtnAsesoria:v(()=>{var e;return l.roles.value.includes("ROLE_PENSUM_STUDENT_ASESORIA_VIEW")&&((e=_.value)==null?void 0:e.show)}),status:v(()=>{var e,o;return(o=(e=_.value)==null?void 0:e.enrolled)==null?void 0:o.estado}),studentEnrolled:v(()=>E.value),subjetsEnrolled:v(()=>n.enrolledSubjects),subjects:v(()=>s.value),inscribir:v(()=>{var e;return J.orderBy((e=_.value)==null?void 0:e.inscribir,["codmate","asc"])}),asesoria:v(()=>c.value.filter(e=>e.visible))}},oe={class:"row"},re={class:"col-3"},ne={class:"col-9"},ie={class:"row d-flex align-items-center justify-content-center"},ce={class:"row"},le={class:"col-6"},de={class:"col-6"},ue=w({__name:"Card",props:{subject:null},setup(a){const l=a,{subject:t}=k(l),n=c=>{switch(c){case"A":return"aprobada";case"INSCRIBIR":return"inscribir";case"R":return"reprobada";case"C":return"cursando";default:return""}};return(c,s)=>(d(),u("section",{class:O([n(i(t).estado),"item-subject container-fluid"])},[r("header",oe,[r("div",re,[r("strong",null,h(i(t).no_orden),1)]),r("div",ne,h(i(t).codigo_materia),1)]),r("main",ie,h(i(t).nombre_materia),1),r("article",ce,[r("div",le,h(i(t).requisitos==="0"?"Bachillerato":i(t).requisitos),1),r("div",de,h(i(t).creditos)+" UV",1)])],2))}}),me={class:"table-responsive"},_e={class:"table table-bordered"},ve=w({__name:"List",props:{keys:null,items:null},setup(a){const l=a,{keys:t}=k(l);return(n,c)=>(d(),u("div",me,[r("table",_e,[r("thead",null,[r("tr",null,[(d(!0),u(x,null,A(i(t),s=>(d(),u("th",{key:s},h(s),1))),128))])]),r("tbody",null,[r("tr",null,[(d(!0),u(x,null,A(a.items,(s,p)=>(d(),u("td",{key:p},[(d(!0),u(x,null,A(s,b=>(d(),Q(ue,{key:b.pensum_materia_id,subject:b},null,8,["subject"]))),128))]))),128))])])])]))}});const be=F(ve,[["__scopeId","data-v-2766d120"]]),he={class:"row"},pe=X('<div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject aprobada" data-v-a85b35b8></div><h5 data-v-a85b35b8>Aprobadas</h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject cursando" data-v-a85b35b8></div><h5 data-v-a85b35b8>Cursando</h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject inscribir" data-v-a85b35b8></div><h5 style="margin-left:5px;margin-bottom:0px;" data-v-a85b35b8> Prerequisitos completos </h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject" data-v-a85b35b8></div><h5 data-v-a85b35b8>Pendientes</h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject reprobada" data-v-a85b35b8></div><h5 data-v-a85b35b8>Reprobadas</h5></div>',5),ye={key:0,class:"col-12"},fe=w({__name:"Leyenda",props:{carrera:null},setup(a){const l=a,{carrera:t}=k(l);return(n,c)=>(d(),u("div",he,[pe,i(t)?(d(),u("div",ye,[r("h2",null,h(i(t).nombre),1)])):I("",!0)]))}});const ge=F(fe,[["__scopeId","data-v-a85b35b8"]]),xe=async a=>{const l=new Z.Workbook,t=l.addWorksheet("Horario"),n=[{key:"codmate",header:"Codigo"},{key:"nommate",header:"Materia"},{key:"dias",header:"Dia"},{key:"horario",header:"Horario"},{key:"aula",header:"Aula"}];t.columns=n,a.forEach(s=>{t.addRow({codmate:s.codmate,nommate:s.materia.nommate,dias:s.dias,horario:s.hora,aula:s.aula})}),t.getRow(1).font={name:"Arial",family:2,size:14};const c=new Date().getTime();l.xlsx.writeBuffer().then(s=>{const p=new Blob([s],{type:"application/vnd.ms-excel"});ee.saveAs(p,`horario-${c}.xlsx`)})},we={class:"card"},ke={class:"card-header"},Ee={class:"header-top"},je=r("h5",{class:"m-0"},"Materias",-1),Ae={key:0,class:"",style:{float:"right"}},Se={class:"card-body"},Be=w({__name:"PensumList",setup(a){const l=te(),t=R(),{list:n,inscribir:c,studentEnrolled:s,viewBtnAsesoria:p,carrera:b}=k(l),_=()=>{xe(c.value)},E=()=>{t.push({name:"pensum-asesoria"})};return(L,$)=>{const e=T,o=D;return d(),u(x,null,[y(Y,{title:"Pensum",button:!0}),r("div",we,[r("div",ke,[r("div",null,[r("div",Ee,[je,i(p)?(d(),u("div",Ae,[y(o,{id:"dropdown-1",text:"Asesoria",class:"m-md-2"},{default:S(()=>[y(e,{onClick:_},{default:S(()=>[B(" Descargar horarios ")]),_:1}),y(e,{onClick:E},{default:S(()=>[B(h(i(s)?"Ver asesoria":"Iniciar asesoria"),1)]),_:1})]),_:1})])):I("",!0)])])]),r("div",Se,[y(ge,{carrera:i(b)},null,8,["carrera"]),y(be,{keys:i(n).keys,items:i(n).items},null,8,["keys","items"])])])],64)}}});export{Be as default};
