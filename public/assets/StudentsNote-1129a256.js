import{a as Ye,q as Qe,e as Ae,x as Re,l as Ne,s as Pe,Z as Xe,N as et,k as tt,_ as at,c as nt,v as ot}from"./bootstrap-vue-3.es-0c7ec6a3.js";import{a9 as rt,aa as st,ab as lt,ac as it,ad as ut,ae as ct,af as ft,a3 as dt,ag as vt,V as Be,ah as pt,ai as mt,aj as gt,ak as bt,H as Te,a2 as yt,r as oe,al as ht,am as _t,a0 as wt,an as Dt,ao as xt,I as Ft,i as ze,ap as Ct,j as A,aq as St,ar as Et,x as de,X as je,n as kt,t as P,as as At,at as Rt,a7 as Nt,F as me,au as Pt,av as Bt,aw as Tt,a6 as zt,ax as jt,ay as Mt,az as Ot,aA as $t,aB as Vt,J as re,z as Q,E as se,e as z,g as H,aC as It,aD as Lt,aE as qt,aF as Kt,aG as Ht,k as N,f as _,aH as Jt,d as ge,aI as Ut,aJ as Wt,aK as Gt,aL as Zt,a8 as Yt,aM as Qt,Y as Me,N as Xt,aN as ea,aO as ta,Z as aa,aP as na,aQ as oa,aR as ra,aS as sa,O as Oe,M as la,S as ia,s as ua,W as ca,aT as fa,aU as da,aV as va,o as be,aW as pa,aX as ma,aY as ga,a as ba,aZ as ya,c as k,l as ha,a_ as _a,p as wa,a$ as Da,b0 as xa,v as $e,P as Fa,b as Ca,b1 as Sa,A as Ea,b2 as ka,b3 as Aa,b4 as Ra,b5 as Na,b6 as Pa,b7 as Ba,b8 as Ta,b9 as za,ba as ja,Q as Ma,bb as Oa,L as $a,bc as Va,bd as Ia,be as La,K as qa,a1 as Ka,bf as Ha,bg as Ja,bh as Ua,w as m,bi as Wa,T as Ga,bj as Za,bk as Ya,$ as Qa,bl as Xa,bm as en,bn as tn,bo as an,bp as nn,bq as on,br as rn,bs as sn,bt as ln,bu as un,bv as cn,bw as fn,bx as dn,by as vn,U as pn,bz as mn,a5 as gn,a4 as bn,bA as yn,bB as Ve,bC as Ie,_ as hn,C as _n,D as wn,G as Dn,q as xn}from"./index-d66447e3.js";import{F as Fn,e as Cn,E as Sn}from"./FileSaver.min-4390d796.js";const En=()=>{},kn=Object.freeze(Object.defineProperty({__proto__:null,compile:En,EffectScope:rt,ReactiveEffect:st,customRef:lt,effect:it,effectScope:ut,getCurrentScope:ct,isProxy:ft,isReactive:dt,isReadonly:vt,isRef:Be,isShallow:pt,markRaw:mt,onScopeDispose:gt,proxyRefs:bt,reactive:Te,readonly:yt,ref:oe,shallowReactive:ht,shallowReadonly:_t,shallowRef:wt,stop:Dt,toRaw:xt,toRef:Ft,toRefs:ze,triggerRef:Ct,unref:A,camelize:St,capitalize:Et,normalizeClass:de,normalizeProps:je,normalizeStyle:kt,toDisplayString:P,toHandlerKey:At,BaseTransition:Rt,Comment:Nt,Fragment:me,KeepAlive:Pt,Static:Bt,Suspense:Tt,Teleport:zt,Text:jt,callWithAsyncErrorHandling:Mt,callWithErrorHandling:Ot,cloneVNode:$t,compatUtils:Vt,computed:re,createBlock:Q,createCommentVNode:se,createElementBlock:z,createElementVNode:H,createHydrationRenderer:It,createPropsRestProxy:Lt,createRenderer:qt,createSlots:Kt,createStaticVNode:Ht,createTextVNode:N,createVNode:_,defineAsyncComponent:Jt,defineComponent:ge,defineEmits:Ut,defineExpose:Wt,defineProps:Gt,get devtools(){return Zt},getCurrentInstance:Yt,getTransitionRawChildren:Qt,guardReactiveProps:Me,h:Xt,handleError:ea,initCustomFormatter:ta,inject:aa,isMemoSame:na,isRuntimeOnly:oa,isVNode:ra,mergeDefaults:sa,mergeProps:Oe,nextTick:la,onActivated:ia,onBeforeMount:ua,onBeforeUnmount:ca,onBeforeUpdate:fa,onDeactivated:da,onErrorCaptured:va,onMounted:be,onRenderTracked:pa,onRenderTriggered:ma,onServerPrefetch:ga,onUnmounted:ba,onUpdated:ya,openBlock:k,popScopeId:ha,provide:_a,pushScopeId:wa,queuePostFlushCb:Da,registerRuntimeCompiler:xa,renderList:$e,renderSlot:Fa,resolveComponent:Ca,resolveDirective:Sa,resolveDynamicComponent:Ea,resolveFilter:ka,resolveTransitionHooks:Aa,setBlockTracking:Ra,setDevtoolsHook:Na,setTransitionHooks:Pa,ssrContextKey:Ba,ssrUtils:Ta,toHandlers:za,transformVNodeArgs:ja,useAttrs:Ma,useSSRContext:Oa,useSlots:$a,useTransitionState:Va,version:Ia,warn:La,watch:qa,watchEffect:Ka,watchPostEffect:Ha,watchSyncEffect:Ja,withAsyncContext:Ua,withCtx:m,withDefaults:Wa,withDirectives:Ga,withMemo:Za,withScopeId:Ya,Transition:Qa,TransitionGroup:Xa,VueElement:en,createApp:tn,createSSRApp:an,defineCustomElement:nn,defineSSRCustomElement:on,hydrate:rn,initDirectivesForSSR:sn,render:ln,useCssModule:un,useCssVars:cn,vModelCheckbox:fn,vModelDynamic:dn,vModelRadio:vn,vModelSelect:pn,vModelText:mn,vShow:gn,withKeys:bn,withModifiers:yn},Symbol.toStringTag,{value:"Module"}));function An(e,a=new Date().getTime().toString()){return e.xlsx.writeBuffer().then(t=>{const o=new Blob([t],{type:"application/vnd.ms-excel"});Fn.saveAs(o,`${a}.xlsx`)})}var J=(e=>(e[e.Border=0]="Border",e[e.Protection=1]="Protection",e[e.Validation=2]="Validation",e[e.Fill=3]="Fill",e))(J||{});const fe=(e,a,t,o=J.Border,n="thin",s="F08080")=>{const i={top:{style:n},left:{style:n},bottom:{style:n},right:{style:n}};if(o===J.Fill)for(let l=a.column;l<t.column;l++)e.getCell(a.row,l).fill={type:"pattern",pattern:"solid",fgColor:{argb:s}};else for(let l=a.row;l<t.row;l++)for(let d=a.column;d<t.column;d++)o===J.Border&&(e.getCell(l,d).border=i),o===J.Protection&&(e.getCell(l,d).protection={locked:!1}),o===J.Validation&&(e.getCell(l,d).dataValidation={type:"decimal",operator:"between",allowBlank:!0,showErrorMessage:!0,formulae:[0,10],promptTitle:"Decimal",errorStyle:"error",errorTitle:"Valor no valido",error:"El valor debe ser un numero, Debe ser mayor que cero y menor o igual a 10"})},Rn=(e,a,t)=>{const[o]=e,n=new Cn.Workbook,s=new FileReader;return new Promise((i,l)=>{s.readAsArrayBuffer(o),s.onerror=()=>{l("Tenemos un problema para poder leer el documento")},s.onload=()=>{const d=s.result;n.xlsx.load(d).then(u=>{var b;const c=[],p=u.worksheets[0],$=(b=p.getCell("A1").value)==null?void 0:b.toString();t.toString()!==$&&l("El Documento no es valido para esta asignatura"),p.eachRow({includeEmpty:!0},function(V,C){var j,I,L;if(C>7){const B=p.getRow(C),F=parseFloat((j=B.getCell(a).value)==null?void 0:j.toString())||0;c.push({carnet:((I=B.getCell(3).value)==null?void 0:I.toString())||"",nombre:((L=B.getCell(4).value)==null?void 0:L.toString())||"",color:F<5?"bg-danger":F>=5&&F<=8?"bg-warning":"bg-primary",valor:F})}}),i(c)})}})},Nn=(e,a)=>{const{docente:t,materia:o,codcarga:n,dias:s,hora:i}=a;e.mergeCells("B2:J2"),e.mergeCells("B4:E4"),e.mergeCells("B5:E5"),e.mergeCells("F4:J4"),e.mergeCells("F5:J5"),e.getCell("A1").value=n,e.getCell("J2").value=o.toString(),e.getCell("E4").value=`Codigo: ${n}`,e.getCell("E5").value=`Docente: ${t==null?void 0:t.nombres} ${t==null?void 0:t.apellidos}`,e.getCell("J4").value=`Dias: ${s}`,e.getCell("J5").value=`Horario: ${i}`,[{column:0,width:1},{column:1,width:5.5},{column:2,width:12.1},{column:3,width:48.4},{column:4,width:28.25}].forEach(({column:d,width:u})=>{e.columns[d].width=u})},Pn=e=>{["J2","E4","E5","J4","J5"].map(a=>{const t=a==="J2";e.getCell(a).alignment={vertical:"middle",horizontal:"center"},e.getCell(a).font={name:"Arial",size:t?14:12,bold:!!t}}),e.getCell("A1").font={color:{argb:"FFFFFFFF",theme:1}}},Bn=async e=>{var i;const a=new Sn.Workbook,t=a.addWorksheet("Cuadro de notas"),o=new Date().getTime()+"--pass--word--secret";await t.protect(o,{}),Nn(t,e);let n=new Array;e.alumnos&&(n=(i=e.alumnos)==null?void 0:i.map((l,d)=>[d+1,l.carnet,`${l.apellidos} ${l.nombres}`,`${l.carnet}@utla.edu.sv`,l.nota1||null,l.nota2||null,l.nota3||null,l.nota4||null,l.nota5||null,l.promedio||null])),t.addTable({ref:"B7",name:"notas",headerRow:!0,totalsRow:!1,style:{theme:"TableStyleLight1",showRowStripes:!0},columns:[{name:"#",filterButton:!1},{name:"Carnet",filterButton:!1},{name:"Alumno",filterButton:!1},{name:"Correo",filterButton:!1},{name:"Nota 1",filterButton:!1},{name:"Nota 2",filterButton:!1},{name:"Nota 3",filterButton:!1},{name:"Nota 4",filterButton:!1},{name:"Nota 5",filterButton:!1},{name:"Promedio",filterButton:!1}],rows:[...n]}),Pn(t),fe(t,{row:7,column:2},{column:12,row:8+n.length}),fe(t,{row:8,column:6},{column:11,row:8+n.length},J.Protection),fe(t,{row:8,column:6},{column:11,row:8+n.length},J.Validation);const s=`${e.codmate}-${e.materia}-${new Date().getTime()}`;return An(a,s)};var Le={};const Tn=Ve(kn);function X(e,a,t,o){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function l(c){try{u(o.next(c))}catch(p){i(p)}}function d(c){try{u(o.throw(c))}catch(p){i(p)}}function u(c){c.done?s(c.value):n(c.value).then(l,d)}u((o=o.apply(e,a||[])).next())})}function ee(e,a){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,n,s,i;return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(c){return d([u,c])}}function d(u){if(o)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(t=0)),t;)try{if(o=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,n=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=a.call(e,t)}catch(c){u=[6,c],n=0}finally{o=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function zn(e,a){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),n,s=[],i;try{for(;(a===void 0||a-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s}function jn(){for(var e=[],a=0;a<arguments.length;a++)e=e.concat(zn(arguments[a]));return e}var Mn=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function ie(e,a){var t=On(e);if(typeof t.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof a=="string"?a:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function On(e){var a=e.name,t=a&&a.lastIndexOf(".")!==-1;if(t&&!e.type){var o=a.split(".").pop().toLowerCase(),n=Mn.get(o);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var $n=[".DS_Store","Thumbs.db"];function Vn(e){return X(this,void 0,void 0,function(){return ee(this,function(a){return[2,In(e)&&e.dataTransfer?Kn(e.dataTransfer,e.type):Ln(e)]})})}function In(e){return!!e.dataTransfer}function Ln(e){var a=qn(e.target)?e.target.files?ve(e.target.files):[]:[];return a.map(function(t){return ie(t)})}function qn(e){return e!==null}function Kn(e,a){return X(this,void 0,void 0,function(){var t,o;return ee(this,function(n){switch(n.label){case 0:return e.items?(t=ve(e.items).filter(function(s){return s.kind==="file"}),a!=="drop"?[2,t]:[4,Promise.all(t.map(Hn))]):[3,2];case 1:return o=n.sent(),[2,we(qe(o))];case 2:return[2,we(ve(e.files).map(function(s){return ie(s)}))]}})})}function we(e){return e.filter(function(a){return $n.indexOf(a.name)===-1})}function ve(e){for(var a=[],t=0;t<e.length;t++){var o=e[t];a.push(o)}return a}function Hn(e){if(typeof e.webkitGetAsEntry!="function")return De(e);var a=e.webkitGetAsEntry();return a&&a.isDirectory?Ke(a):De(e)}function qe(e){return e.reduce(function(a,t){return jn(a,Array.isArray(t)?qe(t):[t])},[])}function De(e){var a=e.getAsFile();if(!a)return Promise.reject(e+" is not a File");var t=ie(a);return Promise.resolve(t)}function Jn(e){return X(this,void 0,void 0,function(){return ee(this,function(a){return[2,e.isDirectory?Ke(e):Un(e)]})})}function Ke(e){var a=e.createReader();return new Promise(function(t,o){var n=[];function s(){var i=this;a.readEntries(function(l){return X(i,void 0,void 0,function(){var d,u,c;return ee(this,function(p){switch(p.label){case 0:if(l.length)return[3,5];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return d=p.sent(),t(d),[3,4];case 3:return u=p.sent(),o(u),[3,4];case 4:return[3,6];case 5:c=Promise.all(l.map(Jn)),n.push(c),s(),p.label=6;case 6:return[2]}})})},function(l){o(l)})}s()})}function Un(e){return X(this,void 0,void 0,function(){return ee(this,function(a){return[2,new Promise(function(t,o){e.file(function(n){var s=ie(n,e.fullPath);t(s)},function(n){o(n)})})]})})}const Wn=Object.freeze(Object.defineProperty({__proto__:null,fromEvent:Vn},Symbol.toStringTag,{value:"Module"})),Gn=Ve(Wn);var ye={};ye.__esModule=!0;ye.default=function(e,a){if(e&&a){var t=Array.isArray(a)?a:a.split(","),o=e.name||"",n=(e.type||"").toLowerCase(),s=n.replace(/\/.*$/,"");return t.some(function(i){var l=i.trim().toLowerCase();return l.charAt(0)==="."?o.toLowerCase().endsWith(l):l.endsWith("/*")?s===l.replace(/\/.*$/,""):n===l})}return!0};Object.defineProperty(Le,"__esModule",{value:!0});var E=Tn,Zn=Gn;function Yn(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Qn=Yn(ye),g=function(){return(g=Object.assign||function(e){for(var a,t=1,o=arguments.length;t<o;t++)for(var n in a=arguments[t])Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);return e}).apply(this,arguments)};function xe(e,a){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&a.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)a.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]])}return t}function Xn(e,a,t,o){return new(t||(t=Promise))(function(n,s){function i(u){try{d(o.next(u))}catch(c){s(c)}}function l(u){try{d(o.throw(u))}catch(c){s(c)}}function d(u){var c;u.done?n(u.value):(c=u.value,c instanceof t?c:new t(function(p){p(c)})).then(i,l)}d((o=o.apply(e,a||[])).next())})}function eo(e,a){var t,o,n,s,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,o=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(n=i.trys,!((n=n.length>0&&n[n.length-1])||c[0]!==6&&c[0]!==2)){i=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){i.label=c[1];break}if(c[0]===6&&i.label<n[1]){i.label=n[1],n=c;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(c);break}n[2]&&i.ops.pop(),i.trys.pop();continue}c=a.call(e,i)}catch(p){c=[6,p],o=0}finally{t=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([d,u])}}}function pe(e,a){for(var t=0,o=a.length,n=e.length;t<o;t++,n++)e[n]=a[t];return e}function Fe(e){e.preventDefault()}function ne(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(a){return a==="Files"||a==="application/x-moz-file"}):!!e.target&&!!e.target.files}function le(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():e.cancelBubble!==void 0&&e.cancelBubble}var to={code:"too-many-files",message:"Too many files"},ao=function(e){return e=Array.isArray(e)&&e.length===1?e[0]:e,{code:"file-invalid-type",message:"File type must be "+(Array.isArray(e)?"one of "+e.join(", "):e)}};function Y(e){return e!=null}function Ce(e,a){var t=e.type==="application/x-moz-file"||Qn.default(e,a);return[t,t?null:ao(a)]}var Se=function(e){return{code:"file-too-large",message:"File is larger than "+e+" bytes"}},Ee=function(e){return{code:"file-too-small",message:"File is smaller than "+e+" bytes"}};function ke(e,a,t){if(Y(e.size)&&e.size)if(Y(a)&&Y(t)){if(e.size>t)return[!1,Se(t)];if(e.size<a)return[!1,Ee(a)]}else{if(Y(a)&&e.size<a)return[!1,Ee(a)];if(Y(t)&&e.size>t)return[!1,Se(t)]}return[!0,null]}function T(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return e.some(function(s){return!le(t)&&s&&s.apply(void 0,pe([t],o)),le(t)})}}var no={disabled:!1,getFilesFromEvent:Zn.fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1};function oo(e,a){switch(a.type){case"focus":return g(g({},e),{isFocused:!0});case"blur":return g(g({},e),{isFocused:!1});case"openDialog":return g(g({},e),{isFileDialogActive:!0});case"closeDialog":return g(g({},e),{isFileDialogActive:!1});case"setDraggedFiles":var t=a.isDragActive,o=a.draggedFiles;return g(g({},e),{draggedFiles:o,isDragActive:t});case"setFiles":return g(g({},e),{acceptedFiles:a.acceptedFiles,fileRejections:a.fileRejections});case"reset":return g(g({},e),{isFileDialogActive:!1,isDragActive:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]});default:return e}}var ro=Le.useDropzone=function(e){e===void 0&&(e={});var a=E.ref(g(g({},no),e));E.watch(function(){return g({},e)},function(r){a.value=g(g({},a.value),r)});var t=E.ref(),o=E.ref(),n=function(r,f,y){var w=E.reactive(f),x=function(S){var h=r(E.toRaw(w),S);Object.keys(h).forEach(function(R){w[R]=h[R]})};return y!=null&&x(y),[w,x]}(oo,{isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]}),s=n[0],i=n[1],l=function(){o.value&&(i({type:"openDialog"}),o.value.value="",o.value.click())},d=function(){var r=a.value.onFileDialogCancel;s.isFileDialogActive&&setTimeout(function(){if(o.value){var f=o.value.files;f&&!f.length&&(i({type:"closeDialog"}),typeof r=="function"&&r())}},300)};function u(r){t.value&&(t.value.$el||t.value).isEqualNode(r.target)&&(r.keyCode!==32&&r.keyCode!==13||(r.preventDefault(),l()))}function c(){i({type:"focus"})}function p(){i({type:"blur"})}function $(){var r;a.value.noClick||(r===void 0&&(r=window.navigator.userAgent),function(f){return f.includes("MSIE")||f.includes("Trident/")}(r)||function(f){return f.includes("Edge/")}(r)?setTimeout(l,0):l())}var b=E.ref([]),V=function(r){t.value&&((t.value.$el||t.value).contains(r.target)||(r.preventDefault(),b.value=[]))};function C(r){a.value.noDragEventsBubbling&&r.stopPropagation()}function j(r){return Xn(this,void 0,void 0,function(){var f,y,w,x,S;return eo(this,function(h){switch(h.label){case 0:return f=a.value,y=f.getFilesFromEvent,w=f.noDragEventsBubbling,x=f.onDragEnter,r.preventDefault(),C(r),b.value=pe(pe([],b.value),[r.target]),ne(r)?y?[4,y(r)]:[2]:[3,2];case 1:if((S=h.sent())||(S=[]),le(r)&&!w)return[2];i({draggedFiles:S,isDragActive:!0,type:"setDraggedFiles"}),x&&x(r),h.label=2;case 2:return[2]}})})}function I(r){var f=a.value.onDragOver;if(r.preventDefault(),C(r),r.dataTransfer)try{r.dataTransfer.dropEffect="copy"}catch{}return ne(r)&&f&&f(r),!1}function L(r){r.preventDefault(),C(r);var f=b.value.filter(function(x){return!!t.value&&(t.value.$el||t.value).contains(x)}),y=f.indexOf(r.target);if(y!==-1&&f.splice(y,1),b.value=f,!(f.length>0)){i({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]});var w=a.value.onDragLeave;ne(r)&&w&&w(r)}}function B(r){r.preventDefault(),C(r),b.value=[];var f=a.value,y=f.getFilesFromEvent,w=f.noDragEventsBubbling,x=f.accept,S=f.minSize,h=f.maxSize,R=f.multiple,U=f.maxFiles,W=f.onDrop,te=f.onDropRejected,ae=f.onDropAccepted;if(ne(r)){if(!y)return;Promise.resolve(y(r)).then(function(ce){if(!le(r)||w){var O=[],G=[];ce.forEach(function(Z){var he=Ce(Z,x),He=he[0],Je=he[1],_e=ke(Z,S,h),Ue=_e[0],We=_e[1];if(He&&Ue)O.push(Z);else{var Ge=[Je,We].filter(function(Ze){return Ze});G.push({file:Z,errors:Ge})}}),(!R&&O.length>1||R&&U>=1&&O.length>U)&&(O.forEach(function(Z){G.push({file:Z,errors:[to]})}),O.splice(0)),i({acceptedFiles:O,fileRejections:G,type:"setFiles"}),W&&W(O,G,r),G.length>0&&te&&te(G,r),O.length>0&&ae&&ae(O,r)}})}i({type:"reset"})}E.onMounted(function(){window.addEventListener("focus",d,!1),a.value.preventDropOnDocument&&(document.addEventListener("dragover",Fe,!1),document.addEventListener("drop",V,!1))}),E.onUnmounted(function(){window.removeEventListener("focus",d,!1),a.value.preventDropOnDocument&&(document.removeEventListener("dragover",Fe),document.removeEventListener("drop",V))});var F=function(r){return a.value.disabled?void 0:r},M=function(r){return a.value.noKeyboard?void 0:F(r)},q=function(r){return a.value.noDrag?void 0:F(r)},D=function(r){r.stopPropagation()},v=E.computed(function(){return s.draggedFiles?s.draggedFiles.length:0}),K=E.computed(function(){return v.value>0&&function(r){var f=r.files,y=r.accept,w=r.minSize,x=r.maxSize,S=r.multiple,h=r.maxFiles;return!(!S&&f.length>1||S&&h>=1&&f.length>h)&&f.every(function(R){var U=Ce(R,y)[0],W=ke(R,w,x)[0];return U&&W})}({files:s.draggedFiles,accept:a.value.accept,minSize:a.value.minSize,maxSize:a.value.maxSize,multiple:a.value.multiple,maxFiles:a.value.maxFiles})}),ue=E.computed(function(){return v.value>0&&!K.value});return g(g({},E.toRefs(s)),{isDragAccept:K,isDragReject:ue,isFocused:E.computed(function(){return s.isFocused&&!a.value.disabled}),getRootProps:function(r){r===void 0&&(r={});var f=r.onKeyDown,y=r.onFocus,w=r.onBlur,x=r.onClick,S=r.onDragEnter,h=r.onDragenter,R=r.onDragOver,U=r.onDragover,W=r.onDragLeave,te=r.onDragleave,ae=r.onDrop,ce=xe(r,["onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragenter","onDragOver","onDragover","onDragLeave","onDragleave","onDrop"]);return g(g({onKeyDown:M(T(f,u)),onFocus:M(T(y,c)),onBlur:M(T(w,p)),onClick:F(T(x,$)),onDragenter:q(T(S,h,j)),onDragover:q(T(R,U,I)),onDragleave:q(T(W,te,L)),onDrop:q(T(ae,B)),ref:t},a.value.disabled||a.value.noKeyboard?{}:{tabIndex:0}),ce)},getInputProps:function(r){r===void 0&&(r={});var f=r.onChange,y=r.onClick,w=xe(r,["onChange","onClick"]),x={accept:a.value.accept,multiple:a.value.multiple,style:"display: none",type:"file",onChange:F(T(f,B)),onClick:F(T(y,D)),autoComplete:"off",tabIndex:-1,ref:o};return g(g({},x),w)},rootRef:t,inputRef:o,open:F(l)})};const so={key:0,class:"files"},lo={key:0},io={key:1,class:"text-center"},uo={key:0,class:"text-center"},co={key:0,class:"d-flex justify-content-end mt-4"},fo=ge({__name:"SubirNotasModal",props:{show:{type:Boolean},carga:null},emits:["close","send"],setup(e,{emit:a}){const t=e,o=["carnet","nombre","valor"],n=Ie(),s=oe([]),i=oe(!1),l=oe(void 0),d=new Map;d.set(1,"F"),d.set(2,"G"),d.set(3,"H"),d.set(4,"I"),d.set(5,"J");const u=Te({files:[]}),{getRootProps:c,getInputProps:p,isDragActive:$,...b}=ro({onDrop:function(D){u.files=D},accept:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]}),{show:V,carga:C}=ze(t),j=re(()=>{const D=[],v=C.value;return v.e1==="N"&&D.push({value:1,text:"Nota 1"}),v.e2==="N"&&D.push({value:2,text:"Nota 2"}),v.e3==="N"&&D.push({value:3,text:"Nota 3"}),v.e4==="N"&&D.push({value:4,text:"Nota 4"}),v.e5==="N"&&D.push({value:5,text:"Nota 5"}),D}),I=()=>{M(),a("close")},L=()=>{s.value=[],u.files.splice(0,1)},B=D=>{if(D.preventDefault(),F&&l){const v=l.value!==void 0?d.get(+l.value):"F";Rn(u.files,v,C.value.codcarga).then(K=>{s.value=K,i.value=!0}).catch(K=>{n.showAlert({detail:K,summary:"Error",severity:"error"}),i.value=!1})}},F=re(()=>l&&u.files.length>0),M=()=>{u.files=[],s.value=[],l.value=void 0,i.value=!1},q=()=>{a("send",{notes:s.value.map(({carnet:D,valor:v})=>({carnet:D,valor:v})),note:l.value,idcarga:C.value.codcarga}),M()};return be(()=>{M()}),(D,v)=>{const K=Ye,ue=Qe,r=Ae,f=Re,y=Ne,w=Pe,x=Xe,S=et;return k(),Q(S,{id:"modal-1",title:"Notas",modelValue:A(V),"onUpdate:modelValue":v[1]||(v[1]=h=>Be(V)?V.value=h:null),onHide:I,size:"xl","hide-footer":"",scrollable:"","no-close-on-esc":!0,"no-close-on-backdrop":!0},{default:m(()=>[_(x,{fluid:""},{default:m(()=>[_(f,null,{default:m(()=>[_(r,{cols:"4"},{default:m(()=>[_(ue,{id:"nota-group",label:"Nota","label-for":"nota-input"},{default:m(()=>[_(K,{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=h=>l.value=h),required:"",options:A(j),id:"nota-input"},null,8,["modelValue","options"])]),_:1}),_(f,null,{default:m(()=>[_(r,{class:"mt-3"},{default:m(()=>[u.files.length>0?(k(),z("div",so,[(k(!0),z(me,null,$e(u.files,(h,R)=>(k(),z("div",{class:"file-item",key:R},[H("span",null,P(h.name),1),H("span",{class:"delete-file",onClick:L},"Eliminar")]))),128))])):(k(),z("div",Oe({key:1},A(c)(),{class:"dropzone"}),[H("div",{class:de(["border",{isDragActive:A($)}])},[H("input",je(Me(A(p)())),null,16),A($)?(k(),z("p",lo,"Suelta el archivo aquí ....")):(k(),z("p",io," Arrastre y suelte archivos aquí, o haga clic para seleccionar archivos "))],2)],16))]),_:1})]),_:1}),_(y,{class:"mt-4",disabled:!A(F),onClick:B,variant:"primary"},{default:m(()=>[N("Ver")]),_:1},8,["disabled"])]),_:1}),_(r,{class:"d-flex justify-content-center align-items-center"},{default:m(()=>[s.value.length===0?(k(),z("h2",uo," Debes seleccionar un archivo valido. ")):(k(),Q(w,{key:1,items:s.value,bordered:"",hover:"",small:"",fields:o},{"cell(valor)":m(({item:h})=>[H("span",{class:de(["d-block text-center badge",h.color])},P(h.valor.toFixed(2)),3)]),_:1},8,["items"]))]),_:1})]),_:1})]),_:1}),i.value?(k(),z("div",co,[_(y,{variant:"primary",onClick:q},{default:m(()=>[N("Subir notas")]),_:1})])):se("",!0)]),_:1},8,["modelValue"])}}});const vo=hn(fo,[["__scopeId","data-v-f8a3159e"]]),po={class:"file-content"},mo=H("h5",null,"Listado de estudiantes",-1),ho=ge({__name:"StudentsNote",setup(e){const a=xn(),t=Ie(),o=_n(),{carga:n,open:s}=wn(o),i=[{key:"carnet",label:"Carnet",sortable:!1},{key:"estudiante",label:"Estudiante",sortable:!1},{key:"nota1",label:"Nota 1",sortable:!1},{key:"nota2",label:"Nota 2",sortable:!1},{key:"nota3",label:"Nota 3",sortable:!1},{key:"nota4",label:"Nota 4",sortable:!1},{key:"nota5",label:"Nota 5",sortable:!1},{key:"promedio",label:"Promedio",sortable:!1}],l=re(()=>{var b;return(b=n.value)!=null&&b.materia?n.value.materia.toString():""}),d=async()=>{const b=n.value;b&&await Bn(b)},u=()=>{o.toggleShowModal(!0)},c=()=>{o.toggleShowModal()},p=b=>parseFloat(b).toFixed(2),$=b=>{o.sendNotesCarga(b).then(()=>{t.showAlert({summary:"Exito!",detail:"Proceso realizado con exito",severity:"success"})})};return be(()=>{const{id:b}=a.params;o.getDataCargaAcademica(+b)}),(b,V)=>{const C=Ae,j=Ne,I=tt,L=Re,B=at,F=nt,M=Pe,q=ot;return k(),z(me,null,[_(Dn,{main:"Cargas Academicas",title:A(l),button:!0},null,8,["title"]),H("div",po,[_(q,{"no-body":""},{default:m(()=>{var D;return[_(F,null,{default:m(()=>[_(B,null,{default:m(()=>[_(L,null,{default:m(()=>[_(C,{cols:"8"},{default:m(()=>[mo]),_:1}),_(C,{cols:"4",class:"d-flex justify-content-end"},{default:m(()=>[_(I,null,{default:m(()=>[_(j,{variant:"primary",onClick:d},{default:m(()=>[N("Descargar Listado")]),_:1}),_(j,{onClick:u},{default:m(()=>[N("Subir Notas")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(D=A(n))!=null&&D.alumnos?(k(),Q(M,{key:0,fields:i,items:A(n).alumnos,class:"text-center",striped:"",bordered:"",borderless:"",small:"",hover:""},{"cell(estudiante)":m(({item:v})=>[N(P(v.apellidos)+" "+P(v.nombres),1)]),"cell(nota1)":m(({item:v})=>[N(P(p(v.nota1)),1)]),"cell(nota2)":m(({item:v})=>[N(P(p(v.nota2)),1)]),"cell(nota3)":m(({item:v})=>[N(P(p(v.nota3)),1)]),"cell(nota4)":m(({item:v})=>[N(P(p(v.nota4)),1)]),"cell(nota5)":m(({item:v})=>[N(P(p(v.nota5)),1)]),"cell(promedio)":m(({item:v})=>[N(P(p(v.promedio)),1)]),_:1},8,["items"])):se("",!0)]}),_:1})]),A(n)?(k(),Q(vo,{key:0,show:A(s),onClose:c,onSend:$,carga:A(n)},null,8,["show","carga"])):se("",!0)],64)}}});export{ho as default};
