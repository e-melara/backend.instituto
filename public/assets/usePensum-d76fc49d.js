import{m as h,u as A,bF as E,bG as w,r as d,D as L,bH as S,K as l,bI as j,o as P,bJ as v,J as r,bK as p,h as x}from"./index-39ca847a.js";const F=async(a="me")=>await p.get(`/v1/alumno/${a}/pensum`),K=async(a=[])=>await p.post("pensum",{ids:a}),q=()=>{const a=h(),y=A(),m=x(),n=E();w();const i=d([]),t=d([]),{pensumList:b,asesoria:c,list:u,enrolled:f}=L(n);if(u.value)i.value=c.value;else{const{data:e}=S({queryKey:"pensum",queryFn:()=>F(),onSuccess:s=>{n.setListPensum(s)},onError:s=>{a.showAlert({summary:"Error",severity:"error",detail:"Tenemos un problema por el momento para mostrar la informacion, pongase en contacto con el administrador"}),a.setLoading(!1)},retry:0,cacheTime:0,enabled:!u.value});l(e,s=>{s&&(n.setListPensum(s),a.setLoading(!1))})}const{isLoading:g,mutate:T}=j(e=>K(e),{onSuccess(e){a.showAlert({summary:"Exito",severity:"success",detail:"La matricula fue envianda con exito!"}),n.setSubjectEnrolled(e),m.replace({name:"pensum-list"})},onError(){a.showAlert({summary:"Error",severity:"error",detail:"Por el momento tenemos un problema intenta mas tarde, por favor"}),m.replace({name:"pensum-list"})}});return P(()=>{u.value||a.setLoading(!0)}),l(g,e=>{a.setLoading(e)}),l(c,(e,s)=>{s.length===0&&(i.value=e)}),l(t,e=>{const s=v.map(e,function({materia:o}){return o.codigo});i.value=c.value.map(o=>({...o,visible:!s.includes(o.materia.codigo)}))}),{paginate(e={}){n.getPagination(e)},sendAsesoria(){},validarSubjects:e=>{if(t.value.length>=5){a.showAlert({severity:"error",summary:"Error!",detail:"Solo puedes seleccionar una maximo de 5 materias"});return}if(t.value.some(o=>o.materia_id===e.materia_id)){a.showAlert({severity:"error",summary:"Error!",detail:"Hay una materia ya seleccionada, y solo se puede seleccionar una vez"});return}t.value=[...t.value,e]},removeSubjects:e=>{const s=v.filter(t.value,o=>o.materia.codigo!==e);t.value=[...s]},list:r(()=>b.value),carrera:r(()=>{var e;return(e=u.value)==null?void 0:e.carrera}),viewBtnAsesoria:r(()=>y.roles.value.includes("student.pensum.view")&&!0),status:r(()=>{var e,s;return(s=(e=u.value)==null?void 0:e.enrolled)==null?void 0:s.estado}),studentEnrolled:r(()=>f.value),subjetsEnrolled:r(()=>n.enrolledSubjects),subjects:r(()=>t.value),inscribir:r(()=>{var e;return((e=u.value)==null?void 0:e.cargas_academicas)||[]}),asesoria:r(()=>i.value.filter(e=>e.visible))}};export{q as u};
