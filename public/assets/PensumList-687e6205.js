import{p as T,h as I}from"./bootstrap-vue-3.es-4f9ad53f.js";import{m as q,u as M,bF as H,bG as U,r as P,D as G,bH as K,K as g,bI as W,o as z,J as _,h as F,bJ as J,bK as C,d as w,i as k,c as l,e as u,g as o,t as h,j as i,F as x,v as A,z as O,_ as V,E as R,aG as Q,f as y,w as L,G as X,k as B}from"./index-e0048f3a.js";import{E as Y,F as Z}from"./FileSaver.min-d9b77d56.js";const ee=async(t="me")=>await C.get(`/alumno/${t}/pensum`),se=async(t=[])=>await C.post("pensum",{ids:t}),te=()=>{const t=q(),c=M(),a=F(),r=H();U();const d=P([]),s=P([]),{pensumList:p,asesoria:v,list:b,enrolled:j}=G(r);if(b.value)d.value=v.value;else{const{data:e}=K({queryKey:"pensum",queryFn:()=>ee(),onSuccess:n=>{r.setListPensum(n)},cacheTime:0});g(e,n=>{n&&(r.setListPensum(n),t.setLoading(!1))})}const{isLoading:S,mutate:$}=W(e=>se(e),{onSuccess(e){t.showAlert({summary:"Exito",severity:"success",detail:"La matricula fue envianda con exito!"}),r.setSubjectEnrolled(e),a.replace({name:"pensum-list"})},onError(){t.showAlert({summary:"Error",severity:"error",detail:"Por el momento tenemos un problema intenta mas tarde, por favor"}),a.replace({name:"pensum-list"})}});return z(()=>{b.value||t.setLoading(!0)}),g(S,e=>{t.setLoading(e)}),g(v,(e,n)=>{n.length===0&&(d.value=e)}),g(s,e=>{const n=e.map(m=>m.codmate),E=v.value.map(m=>({...m,visible:!n.includes(m.codmate)}));d.value=E}),{paginate(e={}){r.getPagination(e)},sendAsesoria(){const e=[];s.value.forEach(({item:{id:n}})=>{e.push(n)}),$(e)},validarSubjects:(e,n,E)=>{let m=!0;const{dias:D,horas:N}=e;if(s.value.length>=5&&(m=!1,t.showAlert({severity:"error",summary:"Error!",detail:"Solo puedes seleccionar una maximo de 5 materias"})),m&&s.value.length>0&&(m=!s.value.some(({item:f})=>f.dias===D&&f.horas===N),m||t.showAlert({severity:"error",summary:"Error!",detail:"Hay una materia ya seleccionada con este horario"})),m){const f={item:e,codmate:n,nommate:E};s.value=[f,...s.value]}},removeSubjects:e=>{s.value=s.value.filter(n=>n.codmate!==e)},list:_(()=>p.value),carrera:_(()=>{var e;return(e=b.value)==null?void 0:e.carrera}),viewBtnAsesoria:_(()=>{var e;return c.roles.value.includes("ROLE_PENSUM_STUDENT_ASESORIA_VIEW")&&((e=b.value)==null?void 0:e.show)}),status:_(()=>{var e,n;return(n=(e=b.value)==null?void 0:e.enrolled)==null?void 0:n.estado}),studentEnrolled:_(()=>j.value),subjetsEnrolled:_(()=>r.enrolledSubjects),subjects:_(()=>s.value),inscribir:_(()=>{var e;return J.orderBy((e=b.value)==null?void 0:e.inscribir,["codmate","asc"])}),asesoria:_(()=>d.value.filter(e=>e.visible))}},ae={class:"item-subject container-fluid"},oe={class:"row"},ne={class:"col-3"},re={class:"col-9"},ie={class:"row d-flex align-items-center justify-content-center"},ce={class:"row"},le={class:"col-6"},de={class:"col-6"},ue=w({__name:"Card",props:{subject:null},setup(t){const c=t,{subject:a}=k(c);return(r,d)=>(l(),u("section",ae,[o("header",oe,[o("div",ne,[o("strong",null,h(i(a).no_orden),1)]),o("div",re,h(i(a).codigo_materia),1)]),o("main",ie,h(i(a).nombre_materia),1),o("article",ce,[o("div",le,h(i(a).requisitos==="0"?"Bachillerato":i(a).requisitos),1),o("div",de,h(i(a).creditos)+" UV",1)])]))}}),me={class:"table-responsive"},_e={class:"table table-bordered"},ve=w({__name:"List",props:{keys:null,items:null},setup(t){const c=t,{keys:a}=k(c);return(r,d)=>(l(),u("div",me,[o("table",_e,[o("thead",null,[o("tr",null,[(l(!0),u(x,null,A(i(a),s=>(l(),u("th",{key:s},h(s),1))),128))])]),o("tbody",null,[o("tr",null,[(l(!0),u(x,null,A(t.items,(s,p)=>(l(),u("td",{key:p},[(l(!0),u(x,null,A(s,v=>(l(),O(ue,{key:v.pensum_materia_id,subject:v},null,8,["subject"]))),128))]))),128))])])])]))}});const be=V(ve,[["__scopeId","data-v-2766d120"]]),he={class:"row"},pe=Q('<div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject aprobada" data-v-a85b35b8></div><h5 data-v-a85b35b8>Aprobadas</h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject cursando" data-v-a85b35b8></div><h5 data-v-a85b35b8>Cursando</h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject inscribir" data-v-a85b35b8></div><h5 style="margin-left:5px;margin-bottom:0px;" data-v-a85b35b8> Prerequisitos completos </h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject" data-v-a85b35b8></div><h5 data-v-a85b35b8>Pendientes</h5></div><div class="col d-flex justify-content-evenly align-items-center" data-v-a85b35b8><div class="item-subject reprobada" data-v-a85b35b8></div><h5 data-v-a85b35b8>Reprobadas</h5></div>',5),ye={key:0,class:"col-12"},fe=w({__name:"Leyenda",props:{carrera:null},setup(t){const c=t,{carrera:a}=k(c);return(r,d)=>(l(),u("div",he,[pe,i(a)?(l(),u("div",ye,[o("h2",null,h(i(a).nombre),1)])):R("",!0)]))}});const ge=V(fe,[["__scopeId","data-v-a85b35b8"]]),xe=async t=>{const c=new Y.Workbook,a=c.addWorksheet("Horario"),r=[{key:"codmate",header:"Codigo"},{key:"nommate",header:"Materia"},{key:"dias",header:"Dia"},{key:"horario",header:"Horario"},{key:"aula",header:"Aula"}];a.columns=r,t.forEach(s=>{a.addRow({codmate:s.codmate,nommate:s.materia.nommate,dias:s.dias,horario:s.hora,aula:s.aula})}),a.getRow(1).font={name:"Arial",family:2,size:14};const d=new Date().getTime();c.xlsx.writeBuffer().then(s=>{const p=new Blob([s],{type:"application/vnd.ms-excel"});Z.saveAs(p,`horario-${d}.xlsx`)})},we={class:"card"},ke={class:"card-header"},je={class:"header-top"},Ee=o("h5",{class:"m-0"},"Materias",-1),Ae={key:0,class:"",style:{float:"right"}},Le={class:"card-body"},Be=w({__name:"PensumList",setup(t){const c=te(),a=F(),{list:r,inscribir:d,studentEnrolled:s,viewBtnAsesoria:p,carrera:v}=k(c),b=()=>{xe(d.value)},j=()=>{a.push({name:"pensum-asesoria"})};return(S,$)=>{const e=T,n=I;return l(),u(x,null,[y(X,{title:"Pensum",button:!0}),o("div",we,[o("div",ke,[o("div",null,[o("div",je,[Ee,i(p)?(l(),u("div",Ae,[y(n,{id:"dropdown-1",text:"Asesoria",class:"m-md-2"},{default:L(()=>[y(e,{onClick:b},{default:L(()=>[B(" Descargar horarios ")]),_:1}),y(e,{onClick:j},{default:L(()=>[B(h(i(s)?"Ver asesoria":"Iniciar asesoria"),1)]),_:1})]),_:1})])):R("",!0)])])]),o("div",Le,[y(ge,{carrera:i(v)},null,8,["carrera"]),y(be,{keys:i(r).keys,items:i(r).items},null,8,["keys","items"])])])],64)}}});export{Be as default};
