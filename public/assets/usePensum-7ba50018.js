import{u as A,j as w,bQ as E,r as d,af as S,bR as j,N as l,bS as L,o as x,bJ as v,M as r,bT as y,x as P}from"./index-011ca880.js";const _=async(a="me")=>await y.get(`/v1/alumno/${a}/pensum`),p=async(a=[])=>await y.post("v1/pensum",{ids:a}),M=()=>{const a=A(),b=w(),c=P(),n=E(),i=d([]),o=d([]),{pensumList:f,asesoria:m,list:u,enrolled:g}=S(n);if(u.value)i.value=m.value;else{const{data:e}=j({queryKey:"pensum",queryFn:()=>_(),onSuccess:s=>{n.setListPensum(s)},onError:()=>{a.showAlert({summary:"Error",severity:"error",detail:"Tenemos un problema por el momento para mostrar la informacion, pongase en contacto con el administrador"}),a.setLoading(!1)},retry:0,cacheTime:0,enabled:!u.value});l(e,s=>{s&&(n.setListPensum(s),a.setLoading(!1))})}const{isLoading:h,mutate:T}=L(e=>p(e),{onSuccess(e){a.showAlert({summary:"Exito",severity:"success",detail:"La matricula fue envianda con exito!"}),n.setSubjectEnrolled(e),c.replace({name:"pensum-list"})},onError(){a.showAlert({summary:"Error",severity:"error",detail:"Por el momento tenemos un problema intenta mas tarde, por favor"}),c.replace({name:"pensum-list"})}});return x(()=>{u.value||a.setLoading(!0)}),l(h,e=>{a.setLoading(e)}),l(m,(e,s)=>{s.length===0&&(i.value=e)}),l(o,e=>{const s=v.map(e,function({materia:t}){return t.codigo});i.value=m.value.map(t=>({...t,visible:!s.includes(t.materia.codigo)}))}),{paginate(e={}){n.getPagination(e)},async sendAsesoria(){let e=[];o.value.forEach(function(s){e.push(s.id)});try{await p(e),a.showAlert({summary:"Exito",severity:"success",detail:"Asesoria creada con exito"}),c.push({name:"pensum-student",replace:!0})}catch(s){const{message:t}=s.response.data;a.showAlert({detail:t,severity:"error",summary:"Error"})}},validarSubjects:e=>{if(o.value.length>=5){a.showAlert({severity:"error",summary:"Error!",detail:"Solo puedes seleccionar una maximo de 5 materias"});return}if(o.value.some(t=>t.materia_id===e.materia_id)){a.showAlert({severity:"error",summary:"Error!",detail:"Hay una materia ya seleccionada, y solo se puede seleccionar una vez"});return}o.value=[...o.value,e]},removeSubjects:e=>{const s=v.filter(o.value,t=>t.materia.codigo!==e);o.value=[...s]},list:r(()=>f.value),carrera:r(()=>{var e;return(e=u.value)==null?void 0:e.carrera}),viewBtnAsesoria:r(()=>b.roles.value.includes("student.pensum.view")&&!0),status:r(()=>{var e,s;return(s=(e=u.value)==null?void 0:e.enrolled)==null?void 0:s.estado}),studentEnrolled:r(()=>g.value),subjetsEnrolled:r(()=>n.enrolledSubjects),estado_asesoria:r(()=>n.estado_asesoria),subjects:r(()=>o.value),inscribir:r(()=>{var e;return((e=u.value)==null?void 0:e.cargas_academicas)||[]}),asesoria:r(()=>i.value.filter(e=>e.visible)),viewAsesoriaBtn:r(()=>{var e;return(e=u.value)==null?void 0:e.asesoria_activa})}};export{M as u};
