import{a as et,q as tt,x as Re,e as Pe,l as Be,s as Te,Z as at,N as nt,k as ot,_ as rt,c as st,v as lt}from"./bootstrap-vue-3.es-572774c0.js";import{af as it,ag as ut,ah as ct,ai as ft,aj as dt,ak as vt,al as pt,a8 as mt,am as gt,a5 as je,an as bt,ao as yt,ap as ht,aq as _t,K as ze,$ as wt,r as W,ar as Dt,as as xt,Y as Et,at as Ct,au as Ft,L as St,h as Me,av as kt,i as A,aw as At,ax as Rt,D as fe,V as Oe,n as Pt,t as Q,ay as Bt,az as Tt,a6 as jt,v as me,aA as zt,aB as Mt,aC as Ot,ab as Nt,aD as Vt,aE as $t,aF as It,aG as Lt,aH as qt,M as ge,G as ee,U as se,e as O,g as I,aI as Kt,aJ as Ut,aK as Ht,aL as Wt,aM as Gt,q as G,f as g,aN as Jt,d as be,aO as Zt,aP as Yt,aQ as Qt,aR as Xt,a7 as ea,aS as ta,W as Ne,P as aa,aT as na,aU as oa,a1 as ra,aV as sa,aW as la,aX as ia,aY as ua,p as Ve,O as ca,a0 as fa,A as da,Q as va,aZ as pa,a_ as ma,a$ as ga,o as ye,b0 as ba,b1 as ya,b2 as ha,a as _a,b3 as wa,c as k,z as Da,b4 as xa,y as Ea,b5 as Ca,b6 as Fa,B as $e,S as Sa,b as Ie,b7 as ka,H as Aa,b8 as Ra,b9 as Pa,ba as Ba,bb as Ta,bc as ja,bd as za,be as Ma,bf as Oa,bg as Na,a2 as Va,bh as $a,T as Ia,bi as La,bj as qa,bk as Ka,N as de,Z as Ua,bl as Ha,bm as Wa,bn as Ga,w as p,bo as Ja,a3 as Za,bp as Ya,bq as Qa,X as Xa,br as en,bs as tn,bt as an,bu as nn,bv as on,bw as rn,bx as sn,by as ln,bz as un,bA as cn,bB as fn,bC as dn,bD as vn,bE as pn,a4 as mn,bF as gn,aa as bn,a9 as yn,bG as hn,bH as Le,bI as qe,C as Ke,_ as _n,ac as wn,ad as Dn,ae as xn,x as En}from"./index-0c73a5ee.js";import{F as Cn,e as Fn,E as Sn}from"./FileSaver.min-73ffba6c.js";const kn=()=>{},An=Object.freeze(Object.defineProperty({__proto__:null,compile:kn,EffectScope:it,ReactiveEffect:ut,customRef:ct,effect:ft,effectScope:dt,getCurrentScope:vt,isProxy:pt,isReactive:mt,isReadonly:gt,isRef:je,isShallow:bt,markRaw:yt,onScopeDispose:ht,proxyRefs:_t,reactive:ze,readonly:wt,ref:W,shallowReactive:Dt,shallowReadonly:xt,shallowRef:Et,stop:Ct,toRaw:Ft,toRef:St,toRefs:Me,triggerRef:kt,unref:A,camelize:At,capitalize:Rt,normalizeClass:fe,normalizeProps:Oe,normalizeStyle:Pt,toDisplayString:Q,toHandlerKey:Bt,BaseTransition:Tt,Comment:jt,Fragment:me,KeepAlive:zt,Static:Mt,Suspense:Ot,Teleport:Nt,Text:Vt,callWithAsyncErrorHandling:$t,callWithErrorHandling:It,cloneVNode:Lt,compatUtils:qt,computed:ge,createBlock:ee,createCommentVNode:se,createElementBlock:O,createElementVNode:I,createHydrationRenderer:Kt,createPropsRestProxy:Ut,createRenderer:Ht,createSlots:Wt,createStaticVNode:Gt,createTextVNode:G,createVNode:g,defineAsyncComponent:Jt,defineComponent:be,defineEmits:Zt,defineExpose:Yt,defineProps:Qt,get devtools(){return Xt},getCurrentInstance:ea,getTransitionRawChildren:ta,guardReactiveProps:Ne,h:aa,handleError:na,initCustomFormatter:oa,inject:ra,isMemoSame:sa,isRuntimeOnly:la,isVNode:ia,mergeDefaults:ua,mergeProps:Ve,nextTick:ca,onActivated:fa,onBeforeMount:da,onBeforeUnmount:va,onBeforeUpdate:pa,onDeactivated:ma,onErrorCaptured:ga,onMounted:ye,onRenderTracked:ba,onRenderTriggered:ya,onServerPrefetch:ha,onUnmounted:_a,onUpdated:wa,openBlock:k,popScopeId:Da,provide:xa,pushScopeId:Ea,queuePostFlushCb:Ca,registerRuntimeCompiler:Fa,renderList:$e,renderSlot:Sa,resolveComponent:Ie,resolveDirective:ka,resolveDynamicComponent:Aa,resolveFilter:Ra,resolveTransitionHooks:Pa,setBlockTracking:Ba,setDevtoolsHook:Ta,setTransitionHooks:ja,ssrContextKey:za,ssrUtils:Ma,toHandlers:Oa,transformVNodeArgs:Na,useAttrs:Va,useSSRContext:$a,useSlots:Ia,useTransitionState:La,version:qa,warn:Ka,watch:de,watchEffect:Ua,watchPostEffect:Ha,watchSyncEffect:Wa,withAsyncContext:Ga,withCtx:p,withDefaults:Ja,withDirectives:Za,withMemo:Ya,withScopeId:Qa,Transition:Xa,TransitionGroup:en,VueElement:tn,createApp:an,createSSRApp:nn,defineCustomElement:on,defineSSRCustomElement:rn,hydrate:sn,initDirectivesForSSR:ln,render:un,useCssModule:cn,useCssVars:fn,vModelCheckbox:dn,vModelDynamic:vn,vModelRadio:pn,vModelSelect:mn,vModelText:gn,vShow:bn,withKeys:yn,withModifiers:hn},Symbol.toStringTag,{value:"Module"}));function Rn(e,t=new Date().getTime().toString()){return e.xlsx.writeBuffer().then(a=>{const o=new Blob([a],{type:"application/vnd.ms-excel"});Cn.saveAs(o,`${t}.xlsx`)})}var q=(e=>(e[e.Border=0]="Border",e[e.Protection=1]="Protection",e[e.Validation=2]="Validation",e[e.Fill=3]="Fill",e))(q||{});const ce=(e,t,a,o=q.Border,n="thin",s="F08080")=>{const c={top:{style:n},left:{style:n},bottom:{style:n},right:{style:n}};if(o===q.Fill)for(let u=t.column;u<a.column;u++)e.getCell(t.row,u).fill={type:"pattern",pattern:"solid",fgColor:{argb:s}};else for(let u=t.row;u<=a.row;u++)for(let d=t.column;d<=a.column;d++)o===q.Border&&(e.getCell(u,d).border=c),o===q.Protection&&(e.getCell(u,d).protection={locked:!1}),o===q.Validation&&(e.getCell(u,d).dataValidation={type:"decimal",operator:"between",allowBlank:!0,showErrorMessage:!0,formulae:[0,10],promptTitle:"Decimal",errorStyle:"error",errorTitle:"Valor no valido",error:"El valor debe ser un numero, Debe ser mayor que cero y menor o igual a 10"})},Pn=(e,t,a)=>{const[o]=e,n=new Fn.Workbook,s=new FileReader;return new Promise((c,u)=>{s.readAsArrayBuffer(o),s.onerror=()=>{u("Tenemos un problema para poder leer el documento")},s.onload=()=>{const d=s.result;n.xlsx.load(d).then(i=>{var P;const l=[],v=i.worksheets[0],R=(P=v.getCell("A1").value)==null?void 0:P.toString();t.toString()!==R&&u("El Documento no es valido para esta asignatura"),v.eachRow({includeEmpty:!0},function(K,b){var j,B,N;if(b>7&&b<=a+7){const z=v.getRow(b),E=parseFloat((j=z.getCell(5).value)==null?void 0:j.toString())||0;l.push({carnet:((B=z.getCell(3).value)==null?void 0:B.toString())||"",nombre:((N=z.getCell(4).value)==null?void 0:N.toString())||"",color:E<5?"bg-danger":E>=5&&E<=8?"bg-warning":"bg-primary",valor:E})}}),c(l)})}})},Bn=(e,t,a,o)=>{e.mergeCells("B2:E2"),e.mergeCells("B4:E4"),e.mergeCells("B5:E5"),e.mergeCells("F4:J4"),e.mergeCells("F5:J5");const[n]=t;e.getCell("A1").value=n.carga_academica_id,e.getCell("E2").value=`NOMBRE MATERIA: ${o.nombre}`,e.getCell("E4").value=`Codigo: ${o.codigo}`,e.getCell("E5").value=`Docente: ${a.nombres} ${a.apellidos}`,[{column:0,width:1},{column:1,width:5.5},{column:2,width:12.1},{column:3,width:48.4},{column:4,width:6}].forEach(({column:c,width:u})=>{e.columns[c].width=u})},Tn=e=>{["E2","E4","E5","J4","J5"].map(t=>{const a=t==="E2";e.getCell(t).alignment={vertical:"middle",horizontal:"center"},e.getCell(t).font={name:"Arial",size:a?14:12,bold:!!a}}),e.getCell("A1").font={color:{argb:"FFFFFFFF",theme:1}}},jn=async(e,t)=>{const a=new Sn.Workbook,o=a.addWorksheet("Cuadro de notas"),{materia:n,docente:s}=t.value,c=new Date().getTime()+"--pass--word--secret";await o.protect(c,{});let u=new Array;e&&(Bn(o,e,s,n),u=e.map((i,l)=>[l+1,i.alumno.carnet,`${i.alumno.apellidos} ${i.alumno.nombres}`])),o.addTable({ref:"B7",name:"notas",headerRow:!0,totalsRow:!1,style:{theme:"TableStyleLight1",showRowStripes:!0},columns:[{name:"#",filterButton:!1},{name:"Carnet",filterButton:!1},{name:"Alumno",filterButton:!1},{name:"Nota",filterButton:!1}],rows:[...u]}),Tn(o),ce(o,{row:7,column:12},{column:5,row:8+u.length}),ce(o,{row:8,column:5},{row:8+u.length,column:5},q.Protection),ce(o,{row:8,column:5},{column:5,row:8+u.length},q.Validation);const d=`${n.nombre}-${s.nombres}-${new Date().getTime()}`;return Rn(a,d)};var Ue={};const zn=Le(An);function te(e,t,a,o){function n(s){return s instanceof a?s:new a(function(c){c(s)})}return new(a||(a=Promise))(function(s,c){function u(l){try{i(o.next(l))}catch(v){c(v)}}function d(l){try{i(o.throw(l))}catch(v){c(v)}}function i(l){l.done?s(l.value):n(l.value).then(u,d)}i((o=o.apply(e,t||[])).next())})}function ae(e,t){var a={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,n,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(i){return function(l){return d([i,l])}}function d(i){if(o)throw new TypeError("Generator is already executing.");for(;c&&(c=0,i[0]&&(a=0)),a;)try{if(o=1,n&&(s=i[0]&2?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[i[0]&2,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(i[0]===6||i[0]===2)){a=0;continue}if(i[0]===3&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(i[0]===6&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(l){i=[6,l],n=0}finally{o=s=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function Mn(e,t){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var o=a.call(e),n,s=[],c;try{for(;(t===void 0||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(u){c={error:u}}finally{try{n&&!n.done&&(a=o.return)&&a.call(o)}finally{if(c)throw c.error}}return s}function On(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Mn(arguments[t]));return e}var Nn=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function ie(e,t){var a=Vn(e);if(typeof a.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(a,"path",{value:typeof t=="string"?t:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return a}function Vn(e){var t=e.name,a=t&&t.lastIndexOf(".")!==-1;if(a&&!e.type){var o=t.split(".").pop().toLowerCase(),n=Nn.get(o);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var $n=[".DS_Store","Thumbs.db"];function In(e){return te(this,void 0,void 0,function(){return ae(this,function(t){return[2,Ln(e)&&e.dataTransfer?Un(e.dataTransfer,e.type):qn(e)]})})}function Ln(e){return!!e.dataTransfer}function qn(e){var t=Kn(e.target)?e.target.files?ve(e.target.files):[]:[];return t.map(function(a){return ie(a)})}function Kn(e){return e!==null}function Un(e,t){return te(this,void 0,void 0,function(){var a,o;return ae(this,function(n){switch(n.label){case 0:return e.items?(a=ve(e.items).filter(function(s){return s.kind==="file"}),t!=="drop"?[2,a]:[4,Promise.all(a.map(Hn))]):[3,2];case 1:return o=n.sent(),[2,De(He(o))];case 2:return[2,De(ve(e.files).map(function(s){return ie(s)}))]}})})}function De(e){return e.filter(function(t){return $n.indexOf(t.name)===-1})}function ve(e){for(var t=[],a=0;a<e.length;a++){var o=e[a];t.push(o)}return t}function Hn(e){if(typeof e.webkitGetAsEntry!="function")return xe(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?We(t):xe(e)}function He(e){return e.reduce(function(t,a){return On(t,Array.isArray(a)?He(a):[a])},[])}function xe(e){var t=e.getAsFile();if(!t)return Promise.reject(e+" is not a File");var a=ie(t);return Promise.resolve(a)}function Wn(e){return te(this,void 0,void 0,function(){return ae(this,function(t){return[2,e.isDirectory?We(e):Gn(e)]})})}function We(e){var t=e.createReader();return new Promise(function(a,o){var n=[];function s(){var c=this;t.readEntries(function(u){return te(c,void 0,void 0,function(){var d,i,l;return ae(this,function(v){switch(v.label){case 0:if(u.length)return[3,5];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return d=v.sent(),a(d),[3,4];case 3:return i=v.sent(),o(i),[3,4];case 4:return[3,6];case 5:l=Promise.all(u.map(Wn)),n.push(l),s(),v.label=6;case 6:return[2]}})})},function(u){o(u)})}s()})}function Gn(e){return te(this,void 0,void 0,function(){return ae(this,function(t){return[2,new Promise(function(a,o){e.file(function(n){var s=ie(n,e.fullPath);a(s)},function(n){o(n)})})]})})}const Jn=Object.freeze(Object.defineProperty({__proto__:null,fromEvent:In},Symbol.toStringTag,{value:"Module"})),Zn=Le(Jn);var he={};he.__esModule=!0;he.default=function(e,t){if(e&&t){var a=Array.isArray(t)?t:t.split(","),o=e.name||"",n=(e.type||"").toLowerCase(),s=n.replace(/\/.*$/,"");return a.some(function(c){var u=c.trim().toLowerCase();return u.charAt(0)==="."?o.toLowerCase().endsWith(u):u.endsWith("/*")?s===u.replace(/\/.*$/,""):n===u})}return!0};Object.defineProperty(Ue,"__esModule",{value:!0});var S=zn,Yn=Zn;function Qn(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Xn=Qn(he),m=function(){return(m=Object.assign||function(e){for(var t,a=1,o=arguments.length;a<o;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Ee(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(a[o[n]]=e[o[n]])}return a}function eo(e,t,a,o){return new(a||(a=Promise))(function(n,s){function c(i){try{d(o.next(i))}catch(l){s(l)}}function u(i){try{d(o.throw(i))}catch(l){s(l)}}function d(i){var l;i.done?n(i.value):(l=i.value,l instanceof a?l:new a(function(v){v(l)})).then(c,u)}d((o=o.apply(e,t||[])).next())})}function to(e,t){var a,o,n,s,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(d){return function(i){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,o&&(n=2&l[0]?o.return:l[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,l[1])).done)return n;switch(o=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return c.label++,{value:l[1],done:!1};case 5:c.label++,o=l[1],l=[0];continue;case 7:l=c.ops.pop(),c.trys.pop();continue;default:if(n=c.trys,!((n=n.length>0&&n[n.length-1])||l[0]!==6&&l[0]!==2)){c=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){c.label=l[1];break}if(l[0]===6&&c.label<n[1]){c.label=n[1],n=l;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(l);break}n[2]&&c.ops.pop(),c.trys.pop();continue}l=t.call(e,c)}catch(v){l=[6,v],o=0}finally{a=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([d,i])}}}function pe(e,t){for(var a=0,o=t.length,n=e.length;a<o;a++,n++)e[n]=t[a];return e}function Ce(e){e.preventDefault()}function re(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function le(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():e.cancelBubble!==void 0&&e.cancelBubble}var ao={code:"too-many-files",message:"Too many files"},no=function(e){return e=Array.isArray(e)&&e.length===1?e[0]:e,{code:"file-invalid-type",message:"File type must be "+(Array.isArray(e)?"one of "+e.join(", "):e)}};function X(e){return e!=null}function Fe(e,t){var a=e.type==="application/x-moz-file"||Xn.default(e,t);return[a,a?null:no(t)]}var Se=function(e){return{code:"file-too-large",message:"File is larger than "+e+" bytes"}},ke=function(e){return{code:"file-too-small",message:"File is smaller than "+e+" bytes"}};function Ae(e,t,a){if(X(e.size)&&e.size)if(X(t)&&X(a)){if(e.size>a)return[!1,Se(a)];if(e.size<t)return[!1,ke(t)]}else{if(X(t)&&e.size<t)return[!1,ke(t)];if(X(a)&&e.size>a)return[!1,Se(a)]}return[!0,null]}function M(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(a){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return e.some(function(s){return!le(a)&&s&&s.apply(void 0,pe([a],o)),le(a)})}}var oo={disabled:!1,getFilesFromEvent:Yn.fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1};function ro(e,t){switch(t.type){case"focus":return m(m({},e),{isFocused:!0});case"blur":return m(m({},e),{isFocused:!1});case"openDialog":return m(m({},e),{isFileDialogActive:!0});case"closeDialog":return m(m({},e),{isFileDialogActive:!1});case"setDraggedFiles":var a=t.isDragActive,o=t.draggedFiles;return m(m({},e),{draggedFiles:o,isDragActive:a});case"setFiles":return m(m({},e),{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return m(m({},e),{isFileDialogActive:!1,isDragActive:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]});default:return e}}var so=Ue.useDropzone=function(e){e===void 0&&(e={});var t=S.ref(m(m({},oo),e));S.watch(function(){return m({},e)},function(r){t.value=m(m({},t.value),r)});var a=S.ref(),o=S.ref(),n=function(r,f,y){var _=S.reactive(f),D=function(F){var C=r(S.toRaw(_),F);Object.keys(C).forEach(function(T){_[T]=C[T]})};return y!=null&&D(y),[_,D]}(ro,{isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]}),s=n[0],c=n[1],u=function(){o.value&&(c({type:"openDialog"}),o.value.value="",o.value.click())},d=function(){var r=t.value.onFileDialogCancel;s.isFileDialogActive&&setTimeout(function(){if(o.value){var f=o.value.files;f&&!f.length&&(c({type:"closeDialog"}),typeof r=="function"&&r())}},300)};function i(r){a.value&&(a.value.$el||a.value).isEqualNode(r.target)&&(r.keyCode!==32&&r.keyCode!==13||(r.preventDefault(),u()))}function l(){c({type:"focus"})}function v(){c({type:"blur"})}function R(){var r;t.value.noClick||(r===void 0&&(r=window.navigator.userAgent),function(f){return f.includes("MSIE")||f.includes("Trident/")}(r)||function(f){return f.includes("Edge/")}(r)?setTimeout(u,0):u())}var P=S.ref([]),K=function(r){a.value&&((a.value.$el||a.value).contains(r.target)||(r.preventDefault(),P.value=[]))};function b(r){t.value.noDragEventsBubbling&&r.stopPropagation()}function j(r){return eo(this,void 0,void 0,function(){var f,y,_,D,F;return to(this,function(C){switch(C.label){case 0:return f=t.value,y=f.getFilesFromEvent,_=f.noDragEventsBubbling,D=f.onDragEnter,r.preventDefault(),b(r),P.value=pe(pe([],P.value),[r.target]),re(r)?y?[4,y(r)]:[2]:[3,2];case 1:if((F=C.sent())||(F=[]),le(r)&&!_)return[2];c({draggedFiles:F,isDragActive:!0,type:"setDraggedFiles"}),D&&D(r),C.label=2;case 2:return[2]}})})}function B(r){var f=t.value.onDragOver;if(r.preventDefault(),b(r),r.dataTransfer)try{r.dataTransfer.dropEffect="copy"}catch{}return re(r)&&f&&f(r),!1}function N(r){r.preventDefault(),b(r);var f=P.value.filter(function(D){return!!a.value&&(a.value.$el||a.value).contains(D)}),y=f.indexOf(r.target);if(y!==-1&&f.splice(y,1),P.value=f,!(f.length>0)){c({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]});var _=t.value.onDragLeave;re(r)&&_&&_(r)}}function z(r){r.preventDefault(),b(r),P.value=[];var f=t.value,y=f.getFilesFromEvent,_=f.noDragEventsBubbling,D=f.accept,F=f.minSize,C=f.maxSize,T=f.multiple,x=f.maxFiles,L=f.onDrop,ne=f.onDropRejected,oe=f.onDropAccepted;if(re(r)){if(!y)return;Promise.resolve(y(r)).then(function(ue){if(!le(r)||_){var $=[],Z=[];ue.forEach(function(Y){var _e=Fe(Y,D),Ge=_e[0],Je=_e[1],we=Ae(Y,F,C),Ze=we[0],Ye=we[1];if(Ge&&Ze)$.push(Y);else{var Qe=[Je,Ye].filter(function(Xe){return Xe});Z.push({file:Y,errors:Qe})}}),(!T&&$.length>1||T&&x>=1&&$.length>x)&&($.forEach(function(Y){Z.push({file:Y,errors:[ao]})}),$.splice(0)),c({acceptedFiles:$,fileRejections:Z,type:"setFiles"}),L&&L($,Z,r),Z.length>0&&ne&&ne(Z,r),$.length>0&&oe&&oe($,r)}})}c({type:"reset"})}S.onMounted(function(){window.addEventListener("focus",d,!1),t.value.preventDropOnDocument&&(document.addEventListener("dragover",Ce,!1),document.addEventListener("drop",K,!1))}),S.onUnmounted(function(){window.removeEventListener("focus",d,!1),t.value.preventDropOnDocument&&(document.removeEventListener("dragover",Ce),document.removeEventListener("drop",K))});var E=function(r){return t.value.disabled?void 0:r},U=function(r){return t.value.noKeyboard?void 0:E(r)},V=function(r){return t.value.noDrag?void 0:E(r)},H=function(r){r.stopPropagation()},J=S.computed(function(){return s.draggedFiles?s.draggedFiles.length:0}),w=S.computed(function(){return J.value>0&&function(r){var f=r.files,y=r.accept,_=r.minSize,D=r.maxSize,F=r.multiple,C=r.maxFiles;return!(!F&&f.length>1||F&&C>=1&&f.length>C)&&f.every(function(T){var x=Fe(T,y)[0],L=Ae(T,_,D)[0];return x&&L})}({files:s.draggedFiles,accept:t.value.accept,minSize:t.value.minSize,maxSize:t.value.maxSize,multiple:t.value.multiple,maxFiles:t.value.maxFiles})}),h=S.computed(function(){return J.value>0&&!w.value});return m(m({},S.toRefs(s)),{isDragAccept:w,isDragReject:h,isFocused:S.computed(function(){return s.isFocused&&!t.value.disabled}),getRootProps:function(r){r===void 0&&(r={});var f=r.onKeyDown,y=r.onFocus,_=r.onBlur,D=r.onClick,F=r.onDragEnter,C=r.onDragenter,T=r.onDragOver,x=r.onDragover,L=r.onDragLeave,ne=r.onDragleave,oe=r.onDrop,ue=Ee(r,["onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragenter","onDragOver","onDragover","onDragLeave","onDragleave","onDrop"]);return m(m({onKeyDown:U(M(f,i)),onFocus:U(M(y,l)),onBlur:U(M(_,v)),onClick:E(M(D,R)),onDragenter:V(M(F,C,j)),onDragover:V(M(T,x,B)),onDragleave:V(M(L,ne,N)),onDrop:V(M(oe,z)),ref:a},t.value.disabled||t.value.noKeyboard?{}:{tabIndex:0}),ue)},getInputProps:function(r){r===void 0&&(r={});var f=r.onChange,y=r.onClick,_=Ee(r,["onChange","onClick"]),D={accept:t.value.accept,multiple:t.value.multiple,style:"display: none",type:"file",onChange:E(M(f,z)),onClick:E(M(y,H)),autoComplete:"off",tabIndex:-1,ref:o};return m(m({},D),_)},rootRef:a,inputRef:o,open:E(u)})};const lo={key:0,class:"files"},io={key:0},uo={key:1,class:"text-center"},co={key:0,class:"text-center"},fo={key:0,class:"d-flex justify-content-end mt-4"},vo=be({__name:"SubirNotasModal",props:{show:{type:Boolean},carga:null,data:null},emits:["close","send"],setup(e,{emit:t}){const a=e,o=["#","carnet","nombre","nota"],n=Ke(),s=qe(),c=W([]),u=W([]),d=W(void 0),i=W(void 0),l=W([]),v=W(!1),R=ze({files:[]}),{getRootProps:P,getInputProps:K,isDragActive:b,...j}=so({onDrop:function(w){R.files=w},accept:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]}),{show:B,carga:N}=Me(a);de(()=>a.data.notas,w=>{w&&(c.value=Object.keys(w))},{immediate:!0}),de(()=>d.value,w=>{if(w){const h=a.data.notas[w];i.value=void 0,typeof h=="object"?u.value=Object.keys(h):u.value=[]}});const z=()=>{H(),t("close")},E=()=>{l.value=[],R.files.splice(0,1)},U=w=>{if(w.preventDefault(),u.value.length>0&&i.value===void 0){s.showAlert({detail:"Debes seleccionar una evaluacion",summary:"Error",severity:"error"});return}if(V){const h=n.params.id;Pn(R.files,+h,N.value.length).then(r=>{l.value=r,v.value=!0}).catch(r=>{s.showAlert({detail:r,summary:"Error",severity:"error"}),v.value=!1})}},V=ge(()=>u.value.length>0&&i.value===void 0?!1:R.files.length>0&&d.value!==void 0),H=()=>{R.files=[],l.value=[],d.value=void 0,v.value=!1,u.value=[],i.value=void 0},J=()=>{if(d.value){let w=a.data.notas[d.value];i.value&&(w=w[i.value]);const h={notes:l.value.map(({carnet:r,valor:f})=>({carnet:r,valor:f})),idcarga:n.params.id,key_note:w};t("send",h),H()}else s.showAlert({detail:"Debes seleccionar todas las evaluaciones y subir un archivo valido",summary:"Error",severity:"error"})};return ye(()=>{H()}),(w,h)=>{const r=et,f=tt,y=Re,_=Pe,D=Be,F=Te,C=at,T=nt;return k(),ee(T,{id:"modal-1",title:"Notas",modelValue:A(B),"onUpdate:modelValue":h[2]||(h[2]=x=>je(B)?B.value=x:null),onHide:z,size:"xl","hide-footer":"",scrollable:"","no-close-on-esc":!0,"no-close-on-backdrop":!0},{default:p(()=>[g(C,{fluid:""},{default:p(()=>[g(y,null,{default:p(()=>[g(_,{cols:"4"},{default:p(()=>[g(y,null,{default:p(()=>[g(f,{id:"nota-group",label:"Evaluacion:","label-for":"nota-input"},{default:p(()=>[g(r,{modelValue:d.value,"onUpdate:modelValue":h[0]||(h[0]=x=>d.value=x),required:"",options:c.value,id:"nota-input"},null,8,["modelValue","options"])]),_:1}),u.value.length>0?(k(),ee(f,{key:0,id:"nota-group",label:"Nota: ","label-for":"nota-input-children"},{default:p(()=>[g(r,{modelValue:i.value,"onUpdate:modelValue":h[1]||(h[1]=x=>i.value=x),required:"",options:u.value,id:"nota-input-children"},null,8,["modelValue","options"])]),_:1})):se("",!0)]),_:1}),g(y,null,{default:p(()=>[g(_,{class:"mt-3"},{default:p(()=>[R.files.length>0?(k(),O("div",lo,[(k(!0),O(me,null,$e(R.files,(x,L)=>(k(),O("div",{class:"file-item",key:L},[I("span",null,Q(x.name),1),I("span",{class:"delete-file",onClick:E},"Eliminar")]))),128))])):(k(),O("div",Ve({key:1},A(P)(),{class:"dropzone"}),[I("div",{class:fe(["border",{isDragActive:A(b)}])},[I("input",Oe(Ne(A(K)())),null,16),A(b)?(k(),O("p",io,"Suelta el archivo aquí ....")):(k(),O("p",uo," Arrastre y suelte archivos aquí, o haga clic para seleccionar archivos "))],2)],16))]),_:1})]),_:1}),g(D,{class:"mt-4",disabled:!A(V),onClick:U,variant:"primary"},{default:p(()=>[G("Ver")]),_:1},8,["disabled"])]),_:1}),g(_,{class:"d-flex justify-content-center align-items-center"},{default:p(()=>[l.value.length===0?(k(),O("h2",co," Debes seleccionar un archivo valido. ")):(k(),ee(F,{key:1,items:l.value,bordered:"",hover:"",small:"",fields:o},{"cell(nota)":p(({item:x})=>[I("span",{class:fe(["d-block text-center badge",x.color])},Q(x.valor.toFixed(2)),3)]),"cell(#)":p(({index:x})=>[G(Q(x+1),1)]),_:1},8,["items"]))]),_:1})]),_:1})]),_:1}),v.value?(k(),O("div",fo,[g(D,{variant:"primary",onClick:J},{default:p(()=>[G("Subir notas")]),_:1})])):se("",!0)]),_:1},8,["modelValue"])}}});const po=_n(vo,[["__scopeId","data-v-8553858a"]]),mo={class:"file-content"},go=I("h5",null,"Listado de estudiantes",-1),_o=be({__name:"StudentsNote",setup(e){const t=Ke(),a=En(),o=qe(),n=wn(),{open:s,carga:c,data:u}=Dn(n),d=[{key:"carnet",label:"Carnet",sortable:!1},{key:"estudiante",label:"Estudiante",sortable:!1,class:"text-left"}],i=ge(()=>{var b,j,B;return(j=(b=u.value)==null?void 0:b.materia)!=null&&j.nombre?(B=u.value.materia)==null?void 0:B.nombre.toString():""}),l=async()=>{const b=c.value;b&&await jn(b,u)},v=()=>{n.toggleShowModal(!0)},R=()=>{n.toggleShowModal()},P=async b=>{n.sendNotesCarga(b).then(async j=>{j.response.status===200?(await n.getDataConfigMateria(+t.params.id),o.showAlert({summary:"Exito!",detail:"Proceso realizado con exito",severity:"success"})):o.showAlert({summary:"Error!",detail:"Proceso no realizado",severity:"error"})})},K=()=>{a.push({name:"notes-docente"})};return ye(()=>{const{id:b}=t.params;n.getDataConfigMateria(+b),n.getDataCargaAcademica(+b)}),(b,j)=>{const B=Ie("vue-feather"),N=Pe,z=Be,E=ot,U=Re,V=rt,H=st,J=Te,w=lt;return k(),O(me,null,[g(xn,{main:"Cargas Academicas",title:A(i),button:!0},{back:p(()=>[I("button",{class:"btn btn-primary align-items-center d-flex justify-content-center",style:{"margin-right":"15px",padding:"0px 20px"},onClick:K},[g(B,{type:"arrow-left"})])]),_:1},8,["title"]),I("div",mo,[g(w,{"no-body":""},{default:p(()=>[g(H,null,{default:p(()=>[g(V,null,{default:p(()=>[g(U,null,{default:p(()=>[g(N,{cols:"8"},{default:p(()=>[go]),_:1}),g(N,{cols:"4",class:"d-flex justify-content-end"},{default:p(()=>[g(E,null,{default:p(()=>[g(z,{variant:"primary",onClick:l},{default:p(()=>[G("Descargar Listado")]),_:1}),g(z,{onClick:v},{default:p(()=>[G("Subir Notas")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),g(J,{fields:d,items:A(c),striped:"",bordered:"",borderless:"",small:"",hover:""},{"cell(estudiante)":p(({item:h})=>{var r,f;return[G(Q((r=h==null?void 0:h.alumno)==null?void 0:r.apellidos)+" "+Q((f=h==null?void 0:h.alumno)==null?void 0:f.nombres),1)]}),_:1},8,["items"])]),_:1})]),A(c)&&A(u)?(k(),ee(po,{key:0,show:A(s),onClose:R,onSend:P,carga:A(c),data:A(u)},null,8,["show","carga","data"])):se("",!0)],64)}}});export{_o as default};
