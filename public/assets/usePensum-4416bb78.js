import{u as h,j as E,bP as A,r as d,af as S,bQ as j,N as l,bR as w,o as L,bJ as v,M as t,bS as p,x as P}from"./index-4fe17480.js";const x=async(a="me")=>await p.get(`/v1/alumno/${a}/pensum`),F=async(a=[])=>await p.post("v1/pensum",{ids:a}),T=()=>{const a=h(),y=E(),m=P(),n=A(),i=d([]),r=d([]),{pensumList:b,asesoria:c,list:u,enrolled:f}=S(n);if(u.value)i.value=c.value;else{const{data:e}=j({queryKey:"pensum",queryFn:()=>x(),onSuccess:s=>{n.setListPensum(s)},onError:()=>{a.showAlert({summary:"Error",severity:"error",detail:"Tenemos un problema por el momento para mostrar la informacion, pongase en contacto con el administrador"}),a.setLoading(!1)},retry:0,cacheTime:0,enabled:!u.value});l(e,s=>{s&&(n.setListPensum(s),a.setLoading(!1))})}const{isLoading:g,mutate:M}=w(e=>F(e),{onSuccess(e){a.showAlert({summary:"Exito",severity:"success",detail:"La matricula fue envianda con exito!"}),n.setSubjectEnrolled(e),m.replace({name:"pensum-list"})},onError(){a.showAlert({summary:"Error",severity:"error",detail:"Por el momento tenemos un problema intenta mas tarde, por favor"}),m.replace({name:"pensum-list"})}});return L(()=>{u.value||a.setLoading(!0)}),l(g,e=>{a.setLoading(e)}),l(c,(e,s)=>{s.length===0&&(i.value=e)}),l(r,e=>{const s=v.map(e,function({materia:o}){return o.codigo});i.value=c.value.map(o=>({...o,visible:!s.includes(o.materia.codigo)}))}),{paginate(e={}){n.getPagination(e)},sendAsesoria(){let e=[];r.value.forEach(function(s){e.push(s.id)})},validarSubjects:e=>{if(r.value.length>=5){a.showAlert({severity:"error",summary:"Error!",detail:"Solo puedes seleccionar una maximo de 5 materias"});return}if(r.value.some(o=>o.materia_id===e.materia_id)){a.showAlert({severity:"error",summary:"Error!",detail:"Hay una materia ya seleccionada, y solo se puede seleccionar una vez"});return}r.value=[...r.value,e]},removeSubjects:e=>{const s=v.filter(r.value,o=>o.materia.codigo!==e);r.value=[...s]},list:t(()=>b.value),carrera:t(()=>{var e;return(e=u.value)==null?void 0:e.carrera}),viewBtnAsesoria:t(()=>y.roles.value.includes("student.pensum.view")&&!0),status:t(()=>{var e,s;return(s=(e=u.value)==null?void 0:e.enrolled)==null?void 0:s.estado}),studentEnrolled:t(()=>f.value),subjetsEnrolled:t(()=>n.enrolledSubjects),subjects:t(()=>r.value),inscribir:t(()=>{var e;return((e=u.value)==null?void 0:e.cargas_academicas)||[]}),asesoria:t(()=>i.value.filter(e=>e.visible))}};export{T as u};
