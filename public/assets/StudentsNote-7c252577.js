import{a as tt,q as at,x as Pe,e as Te,l as Be,s as je,Z as nt,N as ot,k as rt,_ as st,c as lt,b as it,v as ut,y as ct,h as ft}from"./bootstrap-vue-3.es-8ca29f07.js";import{ag as dt,ah as vt,ai as pt,aj as mt,ak as gt,al as bt,am as yt,a9 as ht,an as _t,a4 as ze,ao as wt,ap as Dt,aq as xt,ar as Ct,K as Me,$ as Et,r as K,as as Ft,at as St,Y as kt,au as At,av as Rt,L as Pt,h as Ne,aw as Tt,i as F,ax as Bt,ay as jt,D as de,V as Oe,n as zt,t as H,az as Mt,aA as Nt,a7 as Ot,v as me,aB as Vt,aC as $t,aD as It,ac as Lt,aE as qt,aF as Kt,aG as Ut,aH as Ht,aI as Wt,M as ge,G as ee,U as se,e as O,g as $,aJ as Gt,aK as Jt,aL as Zt,aM as Yt,aN as Qt,q as J,f as v,aO as Xt,d as be,aP as ea,aQ as ta,aR as aa,aS as na,a8 as oa,aT as ra,W as Ve,P as sa,aU as la,aV as ia,a1 as ua,aW as ca,aX as fa,aY as da,aZ as va,p as $e,O as pa,a0 as ma,A as ga,Q as ba,a_ as ya,a$ as ha,b0 as _a,o as ye,b1 as wa,b2 as Da,b3 as xa,a as Ca,b4 as Ea,c as P,z as Fa,a5 as Sa,y as ka,b5 as Aa,b6 as Ra,B as Ie,S as Pa,b as Le,b7 as Ta,H as Ba,b8 as ja,b9 as za,ba as Ma,bb as Na,bc as Oa,bd as Va,be as $a,bf as Ia,bg as La,bh as qa,bi as Ka,T as Ua,bj as Ha,bk as Wa,bl as Ga,N as le,Z as Ja,bm as Za,bn as Ya,bo as Qa,w as p,bp as Xa,a2 as en,bq as tn,br as an,X as nn,bs as on,bt as rn,bu as sn,bv as ln,bw as un,bx as cn,by as fn,bz as dn,bA as vn,bB as pn,bC as mn,bD as gn,bE as bn,bF as yn,a3 as hn,bG as _n,ab as wn,aa as Dn,a6 as xn,bH as qe,bI as Ke,C as Ue,_ as Cn,ad as En,ae as Fn,af as Sn,x as kn}from"./index-5bad5049.js";import{F as An,e as Rn,E as Pn}from"./FileSaver.min-47b2469f.js";import{f as De,_ as Tn,s as Bn}from"./TableNote.vue_vue_type_script_setup_true_lang-b7b8257b.js";const jn=()=>{},zn=Object.freeze(Object.defineProperty({__proto__:null,compile:jn,EffectScope:dt,ReactiveEffect:vt,customRef:pt,effect:mt,effectScope:gt,getCurrentScope:bt,isProxy:yt,isReactive:ht,isReadonly:_t,isRef:ze,isShallow:wt,markRaw:Dt,onScopeDispose:xt,proxyRefs:Ct,reactive:Me,readonly:Et,ref:K,shallowReactive:Ft,shallowReadonly:St,shallowRef:kt,stop:At,toRaw:Rt,toRef:Pt,toRefs:Ne,triggerRef:Tt,unref:F,camelize:Bt,capitalize:jt,normalizeClass:de,normalizeProps:Oe,normalizeStyle:zt,toDisplayString:H,toHandlerKey:Mt,BaseTransition:Nt,Comment:Ot,Fragment:me,KeepAlive:Vt,Static:$t,Suspense:It,Teleport:Lt,Text:qt,callWithAsyncErrorHandling:Kt,callWithErrorHandling:Ut,cloneVNode:Ht,compatUtils:Wt,computed:ge,createBlock:ee,createCommentVNode:se,createElementBlock:O,createElementVNode:$,createHydrationRenderer:Gt,createPropsRestProxy:Jt,createRenderer:Zt,createSlots:Yt,createStaticVNode:Qt,createTextVNode:J,createVNode:v,defineAsyncComponent:Xt,defineComponent:be,defineEmits:ea,defineExpose:ta,defineProps:aa,get devtools(){return na},getCurrentInstance:oa,getTransitionRawChildren:ra,guardReactiveProps:Ve,h:sa,handleError:la,initCustomFormatter:ia,inject:ua,isMemoSame:ca,isRuntimeOnly:fa,isVNode:da,mergeDefaults:va,mergeProps:$e,nextTick:pa,onActivated:ma,onBeforeMount:ga,onBeforeUnmount:ba,onBeforeUpdate:ya,onDeactivated:ha,onErrorCaptured:_a,onMounted:ye,onRenderTracked:wa,onRenderTriggered:Da,onServerPrefetch:xa,onUnmounted:Ca,onUpdated:Ea,openBlock:P,popScopeId:Fa,provide:Sa,pushScopeId:ka,queuePostFlushCb:Aa,registerRuntimeCompiler:Ra,renderList:Ie,renderSlot:Pa,resolveComponent:Le,resolveDirective:Ta,resolveDynamicComponent:Ba,resolveFilter:ja,resolveTransitionHooks:za,setBlockTracking:Ma,setDevtoolsHook:Na,setTransitionHooks:Oa,ssrContextKey:Va,ssrUtils:$a,toHandlers:Ia,transformVNodeArgs:La,useAttrs:qa,useSSRContext:Ka,useSlots:Ua,useTransitionState:Ha,version:Wa,warn:Ga,watch:le,watchEffect:Ja,watchPostEffect:Za,watchSyncEffect:Ya,withAsyncContext:Qa,withCtx:p,withDefaults:Xa,withDirectives:en,withMemo:tn,withScopeId:an,Transition:nn,TransitionGroup:on,VueElement:rn,createApp:sn,createSSRApp:ln,defineCustomElement:un,defineSSRCustomElement:cn,hydrate:fn,initDirectivesForSSR:dn,render:vn,useCssModule:pn,useCssVars:mn,vModelCheckbox:gn,vModelDynamic:bn,vModelRadio:yn,vModelSelect:hn,vModelText:_n,vShow:wn,withKeys:Dn,withModifiers:xn},Symbol.toStringTag,{value:"Module"}));function Mn(e,t=new Date().getTime().toString()){return e.xlsx.writeBuffer().then(a=>{const o=new Blob([a],{type:"application/vnd.ms-excel"});An.saveAs(o,`${t}.xlsx`)})}var U=(e=>(e[e.Border=0]="Border",e[e.Protection=1]="Protection",e[e.Validation=2]="Validation",e[e.Fill=3]="Fill",e))(U||{});const fe=(e,t,a,o=U.Border,n="thin",s="F08080")=>{const c={top:{style:n},left:{style:n},bottom:{style:n},right:{style:n}};if(o===U.Fill)for(let u=t.column;u<a.column;u++)e.getCell(t.row,u).fill={type:"pattern",pattern:"solid",fgColor:{argb:s}};else for(let u=t.row;u<=a.row;u++)for(let d=t.column;d<=a.column;d++)o===U.Border&&(e.getCell(u,d).border=c),o===U.Protection&&(e.getCell(u,d).protection={locked:!1}),o===U.Validation&&(e.getCell(u,d).dataValidation={type:"decimal",operator:"between",allowBlank:!0,showErrorMessage:!0,formulae:[0,10],promptTitle:"Decimal",errorStyle:"error",errorTitle:"Valor no valido",error:"El valor debe ser un numero, Debe ser mayor que cero y menor o igual a 10"})},Nn=(e,t,a)=>{const[o]=e,n=new Rn.Workbook,s=new FileReader;return new Promise((c,u)=>{s.readAsArrayBuffer(o),s.onerror=()=>{u("Tenemos un problema para poder leer el documento")},s.onload=()=>{const d=s.result;n.xlsx.load(d).then(i=>{var B;const l=[],g=i.worksheets[0],T=(B=g.getCell("A1").value)==null?void 0:B.toString();t.toString()!==T&&u("El Documento no es valido para esta asignatura"),g.eachRow({includeEmpty:!0},function(W,j){var I,z,_;if(j>7&&j<=a+7){const k=g.getRow(j),D=parseFloat((I=k.getCell(5).value)==null?void 0:I.toString())||0;l.push({carnet:((z=k.getCell(3).value)==null?void 0:z.toString())||"",nombre:((_=k.getCell(4).value)==null?void 0:_.toString())||"",color:D<5?"bg-danger":D>=5&&D<=8?"bg-warning":"bg-primary",valor:D})}}),c(l)})}})},On=(e,t,a,o)=>{e.mergeCells("B2:E2"),e.mergeCells("B4:E4"),e.mergeCells("B5:E5"),e.mergeCells("F4:J4"),e.mergeCells("F5:J5");const[n]=t;e.getCell("A1").value=n.carga_academica_id,e.getCell("E2").value=`NOMBRE MATERIA: ${o.nombre}`,e.getCell("E4").value=`Codigo: ${o.codigo}`,e.getCell("E5").value=`Docente: ${a.nombres} ${a.apellidos}`,[{column:0,width:1},{column:1,width:5.5},{column:2,width:12.1},{column:3,width:48.4},{column:4,width:6}].forEach(({column:c,width:u})=>{e.columns[c].width=u})},Vn=e=>{["E2","E4","E5","J4","J5"].map(t=>{const a=t==="E2";e.getCell(t).alignment={vertical:"middle",horizontal:"center"},e.getCell(t).font={name:"Arial",size:a?14:12,bold:!!a}}),e.getCell("A1").font={color:{argb:"FFFFFFFF",theme:1}}},$n=async(e,t)=>{const a=new Pn.Workbook,o=a.addWorksheet("Cuadro de notas"),{materia:n,docente:s}=t.value,c=new Date().getTime()+"--pass--word--secret";await o.protect(c,{});let u=new Array;e&&(On(o,e,s,n),u=e.map((i,l)=>[l+1,i.alumno.carnet,`${i.alumno.apellidos} ${i.alumno.nombres}`])),o.addTable({ref:"B7",name:"notas",headerRow:!0,totalsRow:!1,style:{theme:"TableStyleLight1",showRowStripes:!0},columns:[{name:"#",filterButton:!1},{name:"Carnet",filterButton:!1},{name:"Alumno",filterButton:!1},{name:"Nota",filterButton:!1}],rows:[...u]}),Vn(o),fe(o,{row:7,column:12},{column:5,row:8+u.length}),fe(o,{row:8,column:5},{row:8+u.length,column:5},U.Protection),fe(o,{row:8,column:5},{column:5,row:8+u.length},U.Validation);const d=`${n.nombre}-${s.nombres}-${new Date().getTime()}`;return Mn(a,d)};var He={};const In=qe(zn);function te(e,t,a,o){function n(s){return s instanceof a?s:new a(function(c){c(s)})}return new(a||(a=Promise))(function(s,c){function u(l){try{i(o.next(l))}catch(g){c(g)}}function d(l){try{i(o.throw(l))}catch(g){c(g)}}function i(l){l.done?s(l.value):n(l.value).then(u,d)}i((o=o.apply(e,t||[])).next())})}function ae(e,t){var a={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,n,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(i){return function(l){return d([i,l])}}function d(i){if(o)throw new TypeError("Generator is already executing.");for(;c&&(c=0,i[0]&&(a=0)),a;)try{if(o=1,n&&(s=i[0]&2?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[i[0]&2,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(i[0]===6||i[0]===2)){a=0;continue}if(i[0]===3&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(i[0]===6&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(l){i=[6,l],n=0}finally{o=s=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function Ln(e,t){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var o=a.call(e),n,s=[],c;try{for(;(t===void 0||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(u){c={error:u}}finally{try{n&&!n.done&&(a=o.return)&&a.call(o)}finally{if(c)throw c.error}}return s}function qn(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ln(arguments[t]));return e}var Kn=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function ue(e,t){var a=Un(e);if(typeof a.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(a,"path",{value:typeof t=="string"?t:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return a}function Un(e){var t=e.name,a=t&&t.lastIndexOf(".")!==-1;if(a&&!e.type){var o=t.split(".").pop().toLowerCase(),n=Kn.get(o);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var Hn=[".DS_Store","Thumbs.db"];function Wn(e){return te(this,void 0,void 0,function(){return ae(this,function(t){return[2,Gn(e)&&e.dataTransfer?Yn(e.dataTransfer,e.type):Jn(e)]})})}function Gn(e){return!!e.dataTransfer}function Jn(e){var t=Zn(e.target)?e.target.files?ve(e.target.files):[]:[];return t.map(function(a){return ue(a)})}function Zn(e){return e!==null}function Yn(e,t){return te(this,void 0,void 0,function(){var a,o;return ae(this,function(n){switch(n.label){case 0:return e.items?(a=ve(e.items).filter(function(s){return s.kind==="file"}),t!=="drop"?[2,a]:[4,Promise.all(a.map(Qn))]):[3,2];case 1:return o=n.sent(),[2,xe(We(o))];case 2:return[2,xe(ve(e.files).map(function(s){return ue(s)}))]}})})}function xe(e){return e.filter(function(t){return Hn.indexOf(t.name)===-1})}function ve(e){for(var t=[],a=0;a<e.length;a++){var o=e[a];t.push(o)}return t}function Qn(e){if(typeof e.webkitGetAsEntry!="function")return Ce(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?Ge(t):Ce(e)}function We(e){return e.reduce(function(t,a){return qn(t,Array.isArray(a)?We(a):[a])},[])}function Ce(e){var t=e.getAsFile();if(!t)return Promise.reject(e+" is not a File");var a=ue(t);return Promise.resolve(a)}function Xn(e){return te(this,void 0,void 0,function(){return ae(this,function(t){return[2,e.isDirectory?Ge(e):eo(e)]})})}function Ge(e){var t=e.createReader();return new Promise(function(a,o){var n=[];function s(){var c=this;t.readEntries(function(u){return te(c,void 0,void 0,function(){var d,i,l;return ae(this,function(g){switch(g.label){case 0:if(u.length)return[3,5];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return d=g.sent(),a(d),[3,4];case 3:return i=g.sent(),o(i),[3,4];case 4:return[3,6];case 5:l=Promise.all(u.map(Xn)),n.push(l),s(),g.label=6;case 6:return[2]}})})},function(u){o(u)})}s()})}function eo(e){return te(this,void 0,void 0,function(){return ae(this,function(t){return[2,new Promise(function(a,o){e.file(function(n){var s=ue(n,e.fullPath);a(s)},function(n){o(n)})})]})})}const to=Object.freeze(Object.defineProperty({__proto__:null,fromEvent:Wn},Symbol.toStringTag,{value:"Module"})),ao=qe(to);var he={};he.__esModule=!0;he.default=function(e,t){if(e&&t){var a=Array.isArray(t)?t:t.split(","),o=e.name||"",n=(e.type||"").toLowerCase(),s=n.replace(/\/.*$/,"");return a.some(function(c){var u=c.trim().toLowerCase();return u.charAt(0)==="."?o.toLowerCase().endsWith(u):u.endsWith("/*")?s===u.replace(/\/.*$/,""):n===u})}return!0};Object.defineProperty(He,"__esModule",{value:!0});var R=In,no=ao;function oo(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ro=oo(he),y=function(){return(y=Object.assign||function(e){for(var t,a=1,o=arguments.length;a<o;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Ee(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(a[o[n]]=e[o[n]])}return a}function so(e,t,a,o){return new(a||(a=Promise))(function(n,s){function c(i){try{d(o.next(i))}catch(l){s(l)}}function u(i){try{d(o.throw(i))}catch(l){s(l)}}function d(i){var l;i.done?n(i.value):(l=i.value,l instanceof a?l:new a(function(g){g(l)})).then(c,u)}d((o=o.apply(e,t||[])).next())})}function lo(e,t){var a,o,n,s,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(d){return function(i){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,o&&(n=2&l[0]?o.return:l[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,l[1])).done)return n;switch(o=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return c.label++,{value:l[1],done:!1};case 5:c.label++,o=l[1],l=[0];continue;case 7:l=c.ops.pop(),c.trys.pop();continue;default:if(n=c.trys,!((n=n.length>0&&n[n.length-1])||l[0]!==6&&l[0]!==2)){c=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){c.label=l[1];break}if(l[0]===6&&c.label<n[1]){c.label=n[1],n=l;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(l);break}n[2]&&c.ops.pop(),c.trys.pop();continue}l=t.call(e,c)}catch(g){l=[6,g],o=0}finally{a=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([d,i])}}}function pe(e,t){for(var a=0,o=t.length,n=e.length;a<o;a++,n++)e[n]=t[a];return e}function Fe(e){e.preventDefault()}function re(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function ie(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():e.cancelBubble!==void 0&&e.cancelBubble}var io={code:"too-many-files",message:"Too many files"},uo=function(e){return e=Array.isArray(e)&&e.length===1?e[0]:e,{code:"file-invalid-type",message:"File type must be "+(Array.isArray(e)?"one of "+e.join(", "):e)}};function X(e){return e!=null}function Se(e,t){var a=e.type==="application/x-moz-file"||ro.default(e,t);return[a,a?null:uo(t)]}var ke=function(e){return{code:"file-too-large",message:"File is larger than "+e+" bytes"}},Ae=function(e){return{code:"file-too-small",message:"File is smaller than "+e+" bytes"}};function Re(e,t,a){if(X(e.size)&&e.size)if(X(t)&&X(a)){if(e.size>a)return[!1,ke(a)];if(e.size<t)return[!1,Ae(t)]}else{if(X(t)&&e.size<t)return[!1,Ae(t)];if(X(a)&&e.size>a)return[!1,ke(a)]}return[!0,null]}function N(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(a){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return e.some(function(s){return!ie(a)&&s&&s.apply(void 0,pe([a],o)),ie(a)})}}var co={disabled:!1,getFilesFromEvent:no.fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1};function fo(e,t){switch(t.type){case"focus":return y(y({},e),{isFocused:!0});case"blur":return y(y({},e),{isFocused:!1});case"openDialog":return y(y({},e),{isFileDialogActive:!0});case"closeDialog":return y(y({},e),{isFileDialogActive:!1});case"setDraggedFiles":var a=t.isDragActive,o=t.draggedFiles;return y(y({},e),{draggedFiles:o,isDragActive:a});case"setFiles":return y(y({},e),{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return y(y({},e),{isFileDialogActive:!1,isDragActive:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]});default:return e}}var vo=He.useDropzone=function(e){e===void 0&&(e={});var t=R.ref(y(y({},co),e));R.watch(function(){return y({},e)},function(r){t.value=y(y({},t.value),r)});var a=R.ref(),o=R.ref(),n=function(r,f,b){var h=R.reactive(f),w=function(m){var E=r(R.toRaw(h),m);Object.keys(E).forEach(function(A){h[A]=E[A]})};return b!=null&&w(b),[h,w]}(fo,{isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]}),s=n[0],c=n[1],u=function(){o.value&&(c({type:"openDialog"}),o.value.value="",o.value.click())},d=function(){var r=t.value.onFileDialogCancel;s.isFileDialogActive&&setTimeout(function(){if(o.value){var f=o.value.files;f&&!f.length&&(c({type:"closeDialog"}),typeof r=="function"&&r())}},300)};function i(r){a.value&&(a.value.$el||a.value).isEqualNode(r.target)&&(r.keyCode!==32&&r.keyCode!==13||(r.preventDefault(),u()))}function l(){c({type:"focus"})}function g(){c({type:"blur"})}function T(){var r;t.value.noClick||(r===void 0&&(r=window.navigator.userAgent),function(f){return f.includes("MSIE")||f.includes("Trident/")}(r)||function(f){return f.includes("Edge/")}(r)?setTimeout(u,0):u())}var B=R.ref([]),W=function(r){a.value&&((a.value.$el||a.value).contains(r.target)||(r.preventDefault(),B.value=[]))};function j(r){t.value.noDragEventsBubbling&&r.stopPropagation()}function I(r){return so(this,void 0,void 0,function(){var f,b,h,w,m;return lo(this,function(E){switch(E.label){case 0:return f=t.value,b=f.getFilesFromEvent,h=f.noDragEventsBubbling,w=f.onDragEnter,r.preventDefault(),j(r),B.value=pe(pe([],B.value),[r.target]),re(r)?b?[4,b(r)]:[2]:[3,2];case 1:if((m=E.sent())||(m=[]),ie(r)&&!h)return[2];c({draggedFiles:m,isDragActive:!0,type:"setDraggedFiles"}),w&&w(r),E.label=2;case 2:return[2]}})})}function z(r){var f=t.value.onDragOver;if(r.preventDefault(),j(r),r.dataTransfer)try{r.dataTransfer.dropEffect="copy"}catch{}return re(r)&&f&&f(r),!1}function _(r){r.preventDefault(),j(r);var f=B.value.filter(function(w){return!!a.value&&(a.value.$el||a.value).contains(w)}),b=f.indexOf(r.target);if(b!==-1&&f.splice(b,1),B.value=f,!(f.length>0)){c({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]});var h=t.value.onDragLeave;re(r)&&h&&h(r)}}function k(r){r.preventDefault(),j(r),B.value=[];var f=t.value,b=f.getFilesFromEvent,h=f.noDragEventsBubbling,w=f.accept,m=f.minSize,E=f.maxSize,A=f.multiple,C=f.maxFiles,q=f.onDrop,ne=f.onDropRejected,oe=f.onDropAccepted;if(re(r)){if(!b)return;Promise.resolve(b(r)).then(function(ce){if(!ie(r)||h){var V=[],Y=[];ce.forEach(function(Q){var _e=Se(Q,w),Je=_e[0],Ze=_e[1],we=Re(Q,m,E),Ye=we[0],Qe=we[1];if(Je&&Ye)V.push(Q);else{var Xe=[Ze,Qe].filter(function(et){return et});Y.push({file:Q,errors:Xe})}}),(!A&&V.length>1||A&&C>=1&&V.length>C)&&(V.forEach(function(Q){Y.push({file:Q,errors:[io]})}),V.splice(0)),c({acceptedFiles:V,fileRejections:Y,type:"setFiles"}),q&&q(V,Y,r),Y.length>0&&ne&&ne(Y,r),V.length>0&&oe&&oe(V,r)}})}c({type:"reset"})}R.onMounted(function(){window.addEventListener("focus",d,!1),t.value.preventDropOnDocument&&(document.addEventListener("dragover",Fe,!1),document.addEventListener("drop",W,!1))}),R.onUnmounted(function(){window.removeEventListener("focus",d,!1),t.value.preventDropOnDocument&&(document.removeEventListener("dragover",Fe),document.removeEventListener("drop",W))});var D=function(r){return t.value.disabled?void 0:r},L=function(r){return t.value.noKeyboard?void 0:D(r)},M=function(r){return t.value.noDrag?void 0:D(r)},G=function(r){r.stopPropagation()},Z=R.computed(function(){return s.draggedFiles?s.draggedFiles.length:0}),x=R.computed(function(){return Z.value>0&&function(r){var f=r.files,b=r.accept,h=r.minSize,w=r.maxSize,m=r.multiple,E=r.maxFiles;return!(!m&&f.length>1||m&&E>=1&&f.length>E)&&f.every(function(A){var C=Se(A,b)[0],q=Re(A,h,w)[0];return C&&q})}({files:s.draggedFiles,accept:t.value.accept,minSize:t.value.minSize,maxSize:t.value.maxSize,multiple:t.value.multiple,maxFiles:t.value.maxFiles})}),S=R.computed(function(){return Z.value>0&&!x.value});return y(y({},R.toRefs(s)),{isDragAccept:x,isDragReject:S,isFocused:R.computed(function(){return s.isFocused&&!t.value.disabled}),getRootProps:function(r){r===void 0&&(r={});var f=r.onKeyDown,b=r.onFocus,h=r.onBlur,w=r.onClick,m=r.onDragEnter,E=r.onDragenter,A=r.onDragOver,C=r.onDragover,q=r.onDragLeave,ne=r.onDragleave,oe=r.onDrop,ce=Ee(r,["onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragenter","onDragOver","onDragover","onDragLeave","onDragleave","onDrop"]);return y(y({onKeyDown:L(N(f,i)),onFocus:L(N(b,l)),onBlur:L(N(h,g)),onClick:D(N(w,T)),onDragenter:M(N(m,E,I)),onDragover:M(N(A,C,z)),onDragleave:M(N(q,ne,_)),onDrop:M(N(oe,k)),ref:a},t.value.disabled||t.value.noKeyboard?{}:{tabIndex:0}),ce)},getInputProps:function(r){r===void 0&&(r={});var f=r.onChange,b=r.onClick,h=Ee(r,["onChange","onClick"]),w={accept:t.value.accept,multiple:t.value.multiple,style:"display: none",type:"file",onChange:D(N(f,k)),onClick:D(N(b,G)),autoComplete:"off",tabIndex:-1,ref:o};return y(y({},w),h)},rootRef:a,inputRef:o,open:D(u)})};const po={key:0,class:"files"},mo={key:0},go={key:1,class:"text-center"},bo={key:0,class:"text-center"},yo={key:0,class:"d-flex justify-content-end mt-4"},ho=be({__name:"SubirNotasModal",props:{show:{type:Boolean},carga:null,data:null},emits:["close","send"],setup(e,{emit:t}){const a=e,o=["#","carnet","nombre","nota"],n=Ue(),s=Ke(),c=K([]),u=K([]),d=K(void 0),i=K(void 0),l=K([]),g=K(!1),T=Me({files:[]}),{getRootProps:B,getInputProps:W,isDragActive:j,...I}=vo({onDrop:function(x){T.files=x},accept:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]}),{show:z,carga:_}=Ne(a);le(()=>a.data.notas,x=>{x&&(c.value=Object.keys(x))},{immediate:!0}),le(()=>d.value,x=>{if(x){const S=a.data.notas[x];i.value=void 0,typeof S=="object"?u.value=Object.keys(S):u.value=[]}});const k=()=>{G(),t("close")},D=()=>{l.value=[],T.files.splice(0,1)},L=x=>{if(x.preventDefault(),u.value.length>0&&i.value===void 0){s.showAlert({detail:"Debes seleccionar una evaluacion",summary:"Error",severity:"error"});return}if(M){const S=n.params.id;Nn(T.files,+S,_.value.length).then(r=>{l.value=r,g.value=!0}).catch(r=>{s.showAlert({detail:r,summary:"Error",severity:"error"}),g.value=!1})}},M=ge(()=>u.value.length>0&&i.value===void 0?!1:T.files.length>0&&d.value!==void 0),G=()=>{T.files=[],l.value=[],d.value=void 0,g.value=!1,u.value=[],i.value=void 0},Z=()=>{if(d.value){let x=a.data.notas[d.value];i.value&&(x=x[i.value]);const S={notes:l.value.map(({carnet:r,valor:f})=>({carnet:r,valor:f})),idcarga:n.params.id,key_note:x};t("send",S),G()}else s.showAlert({detail:"Debes seleccionar todas las evaluaciones y subir un archivo valido",summary:"Error",severity:"error"})};return ye(()=>{G()}),(x,S)=>{const r=tt,f=at,b=Pe,h=Te,w=Be,m=je,E=nt,A=ot;return P(),ee(A,{id:"modal-1",title:"Notas",modelValue:F(z),"onUpdate:modelValue":S[2]||(S[2]=C=>ze(z)?z.value=C:null),onHide:k,size:"xl","hide-footer":"",scrollable:"","no-close-on-esc":!0,"no-close-on-backdrop":!0},{default:p(()=>[v(E,{fluid:""},{default:p(()=>[v(b,null,{default:p(()=>[v(h,{cols:"4"},{default:p(()=>[v(b,null,{default:p(()=>[v(f,{id:"nota-group",label:"Evaluacion:","label-for":"nota-input"},{default:p(()=>[v(r,{modelValue:d.value,"onUpdate:modelValue":S[0]||(S[0]=C=>d.value=C),required:"",options:c.value,id:"nota-input"},null,8,["modelValue","options"])]),_:1}),u.value.length>0?(P(),ee(f,{key:0,id:"nota-group",label:"Nota: ","label-for":"nota-input-children"},{default:p(()=>[v(r,{modelValue:i.value,"onUpdate:modelValue":S[1]||(S[1]=C=>i.value=C),required:"",options:u.value,id:"nota-input-children"},null,8,["modelValue","options"])]),_:1})):se("",!0)]),_:1}),v(b,null,{default:p(()=>[v(h,{class:"mt-3"},{default:p(()=>[T.files.length>0?(P(),O("div",po,[(P(!0),O(me,null,Ie(T.files,(C,q)=>(P(),O("div",{class:"file-item",key:q},[$("span",null,H(C.name),1),$("span",{class:"delete-file",onClick:D},"Eliminar")]))),128))])):(P(),O("div",$e({key:1},F(B)(),{class:"dropzone"}),[$("div",{class:de(["border",{isDragActive:F(j)}])},[$("input",Oe(Ve(F(W)())),null,16),F(j)?(P(),O("p",mo,"Suelta el archivo aquí ....")):(P(),O("p",go," Arrastre y suelte archivos aquí, o haga clic para seleccionar archivos "))],2)],16))]),_:1})]),_:1}),v(w,{class:"mt-4",disabled:!F(M),onClick:L,variant:"primary"},{default:p(()=>[J("Ver")]),_:1},8,["disabled"])]),_:1}),v(h,{class:"d-flex justify-content-center align-items-center"},{default:p(()=>[l.value.length===0?(P(),O("h2",bo," Debes seleccionar un archivo valido. ")):(P(),ee(m,{key:1,items:l.value,bordered:"",hover:"",small:"",fields:o},{"cell(nota)":p(({item:C})=>[$("span",{class:de(["d-block text-center badge",C.color])},H(C.valor.toFixed(2)),3)]),"cell(#)":p(({index:C})=>[J(H(C+1),1)]),_:1},8,["items"]))]),_:1})]),_:1})]),_:1}),g.value?(P(),O("div",yo,[v(w,{variant:"primary",onClick:Z},{default:p(()=>[J("Subir notas")]),_:1})])):se("",!0)]),_:1},8,["modelValue"])}}});const _o=Cn(ho,[["__scopeId","data-v-8553858a"]]),wo={class:"file-content"},Do=$("h5",null,"Listado de estudiantes",-1),So=be({__name:"StudentsNote",setup(e){const t=Ue(),a=kn(),o=Ke(),n=En(),s=K(0),{open:c,carga:u,data:d}=Fn(n);le(d,async _=>{const k=await Bn(_.config);s.value=k.number_of_columns});const i=[{key:"carnet",label:"Carnet",sortable:!1},{key:"estudiante",label:"Estudiante",sortable:!1,class:"text-left"},{key:"nota_final",label:"Nota",sortable:!1,class:"text-center"},{key:"estado",label:"",sortable:!1,class:"text-center",variant:"info",stickyColumn:!0}],l=ge(()=>{var _,k,D;return(k=(_=d.value)==null?void 0:_.materia)!=null&&k.nombre?(D=d.value.materia)==null?void 0:D.nombre.toString():""}),g=async()=>{const _=u.value;_&&await $n(_,d)},T=()=>{n.toggleShowModal(!0)},B=()=>{n.toggleShowModal()},W=async _=>{n.sendNotesCarga(_).then(async k=>{k.response.status===200?(await n.getDataConfigMateria(+t.params.id),await I(),o.showAlert({summary:"Exito!",detail:"Proceso realizado con exito",severity:"success"})):o.showAlert({summary:"Error!",detail:"Proceso no realizado",severity:"error"})})},j=()=>{a.push({name:"notes-docente"})},I=async()=>{const{id:_}=t.params;await n.getDataConfigMateria(+_),await n.getDataCargaAcademica(+_)},z=({codigo:_})=>{switch(_){case"001":return"success";case"002":return"danger";case"003":return"primary"}};return ye(()=>{I()}),(_,k)=>{const D=Le("vue-feather"),L=Te,M=Be,G=rt,Z=Pe,x=st,S=lt,r=it,f=je,b=ut,h=ct,w=ft;return P(),O(me,null,[v(Sn,{main:"Cargas Academicas",title:F(l),button:!0},{back:p(()=>[$("button",{class:"btn btn-primary align-items-center d-flex justify-content-center",style:{"margin-right":"15px",padding:"0px 20px"},onClick:j},[v(D,{type:"arrow-left"})])]),_:1},8,["title"]),$("div",wo,[v(b,{"no-body":""},{default:p(()=>[v(w,{class:"tabs-student",card:""},{default:p(()=>[v(h,{title:"Alumnos",active:""},{default:p(()=>[v(x,null,{default:p(()=>[v(b,{"no-body":""},{default:p(()=>[v(S,null,{default:p(()=>[v(x,null,{default:p(()=>[v(Z,null,{default:p(()=>[v(L,{cols:"8"},{default:p(()=>[Do]),_:1}),v(L,{cols:"4",class:"d-flex justify-content-end"},{default:p(()=>[v(G,null,{default:p(()=>[v(M,{title:"Descargar Listado",variant:"primary",onClick:g},{default:p(()=>[v(D,{type:"download-cloud"})]),_:1}),v(M,{onClick:T,title:"Subir Notas"},{default:p(()=>[v(D,{type:"upload-cloud"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),v(f,{fields:i,items:F(u),striped:"",bordered:"",borderless:"",small:"",hover:""},{"cell(estudiante)":p(({item:m})=>{var E,A;return[J(H((E=m==null?void 0:m.alumno)==null?void 0:E.apellidos)+" "+H((A=m==null?void 0:m.alumno)==null?void 0:A.nombres),1)]}),"cell(nota_final)":p(({item:m})=>[J(H(s.value!==0?F(De)(m[`nota_${s.value}`]):F(De)(0)),1)]),"cell(estado)":p(({item:m})=>[v(r,{show:"",variant:z(m.estado),class:"p-0"},{default:p(()=>[J(H(m.estado.codigo==="001"?"Aprobado":m.estado.codigo==="002"?"Reprobado":"En curso"),1)]),_:2},1032,["variant"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),v(h,{title:"Notas"},{default:p(()=>{var m;return[v(Tn,{config:(m=F(d))==null?void 0:m.config,alumnos:F(u)},null,8,["config","alumnos"])]}),_:1})]),_:1})]),_:1})]),F(u)&&F(d)?(P(),ee(_o,{key:0,show:F(c),onClose:B,onSend:W,carga:F(u),data:F(d)},null,8,["show","carga","data"])):se("",!0)],64)}}});export{So as default};
